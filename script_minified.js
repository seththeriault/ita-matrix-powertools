function startScript(){null===document.getElementById("mptSettingsContainer")&&(injectCss(),createUsersettings()),window.location.href!==mptSettings.laststatus&&(setTimeout(function(){getPageLang()},100),mptSettings.laststatus=window.location.href),1===mptSettings.scriptrunning&&setTimeout(function(){startScript()},500)}function createUsersettings(){var e="",t=document.createElement("div");t.setAttribute("id","mptSettingsContainer"),t.setAttribute("style","border-bottom: 1px dashed grey;"),t.innerHTML='<div><div style="display:inline-block;float:left;">Powertools running</div><div id="mtpNotification" style="margin-left:50px;display:inline-block;"></div><div id="settingsvistoggler" style="display:inline-block;float:right;cursor:pointer;">Show/Hide Settings</div><div id="mptSettings" class="invis" style="display:none;border-top: 1px dotted grey;"><div>';var n=document.getElementById("contentwrapper");n.parentNode.insertBefore(t,n),document.getElementById("settingsvistoggler").onclick=function(){toggleSettingsvis()},n=document.getElementById("mptSettings"),e='<div style="float:left;width:25%">',e+='<div id="mpttimeformat" style="cursor:pointer;">Timeformat:<label>'+printSettingsvalue("timeformat")+"</label></div>",e+='<div id="mptlanguage" style="cursor:pointer;">Language:<label>'+printSettingsvalue("language")+"</label></div>",e+='<div id="mptenableDeviders" style="cursor:pointer;">Enable deviders:<label>'+printSettingsvalue("enableDeviders")+"</label></div>",e+='<div id="mptenableInlinemode" style="cursor:pointer;">Inlinemode:<label>'+printSettingsvalue("enableInlinemode")+"</label></div>",e+='<div id="mptenableFarerules" style="cursor:pointer;">Open fare-rules in new window:<label>'+printSettingsvalue("enableFarerules")+"</label></div>",e+='</div><div style="float:left;width:25%">',e+='<div id="mptenablePricebreakdown" style="cursor:pointer;">Price breakdown:<label>'+printSettingsvalue("enablePricebreakdown")+"</label></div>",e+='<div id="mptenableMilesbreakdown" style="cursor:pointer;">Miles breakdown:<label>'+printSettingsvalue("enableMilesbreakdown")+"</label></div>",e+='<div id="mptenableMilesbreakdownautoload" style="cursor:pointer;">Miles breakdown autoload:<label>'+printSettingsvalue("enableMilesbreakdownautoload")+"</label></div>",e+='<div id="mptenableMilesInlinemode" style="cursor:pointer;">Print miles breakdown inline:<label>'+printSettingsvalue("enableMilesInlinemode")+"</label></div>",e+='<div id="mptenableIMGautoload" style="cursor:pointer;">Images autoload:<label>'+printSettingsvalue("enableIMGautoload")+"</label></div>",e+='</div><div style="float:left;width:25%">',e+='<div id="mptenablePlanefinder" style="cursor:pointer;">Enable Planefinder:<label>'+printSettingsvalue("enablePlanefinder")+"</label></div>",e+='<div id="mptenableSeatguru" style="cursor:pointer;">Enable Seatguru:<label>'+printSettingsvalue("enableSeatguru")+"</label></div>",e+='<div id="mptenableWheretocredit" style="cursor:pointer;">Enable WhereToCredit:<label>'+printSettingsvalue("enableWheretocredit")+"</label></div>",e+='</div><div style="float:left;width:25%">',e+='<div id="mptacEdition" style="cursor:pointer;">Air Canada Edition:<label>'+printSettingsvalue("acEdition")+"</label></div>",e+='<div id="mptaaEdition" style="cursor:pointer;">American Edition:<label>'+printSettingsvalue("aaEdition")+"</label></div>",e+='</div><div style="clear:both;"></div>',n.innerHTML=e,document.getElementById("mpttimeformat").onclick=function(){toggleSettings("timeformat")},document.getElementById("mptlanguage").onclick=function(){toggleSettings("language")},document.getElementById("mptenableDeviders").onclick=function(){toggleSettings("enableDeviders")},document.getElementById("mptenableInlinemode").onclick=function(){toggleSettings("enableInlinemode")},document.getElementById("mptenableIMGautoload").onclick=function(){toggleSettings("enableIMGautoload")},document.getElementById("mptenableFarerules").onclick=function(){toggleSettings("enableFarerules")},document.getElementById("mptenablePricebreakdown").onclick=function(){toggleSettings("enablePricebreakdown")},document.getElementById("mptenableMilesbreakdown").onclick=function(){toggleSettings("enableMilesbreakdown")},document.getElementById("mptenableMilesbreakdownautoload").onclick=function(){toggleSettings("enableMilesbreakdownautoload")},document.getElementById("mptenableMilesInlinemode").onclick=function(){toggleSettings("enableMilesInlinemode")},document.getElementById("mptenablePlanefinder").onclick=function(){toggleSettings("enablePlanefinder")},document.getElementById("mptenableSeatguru").onclick=function(){toggleSettings("enableSeatguru")},document.getElementById("mptenableWheretocredit").onclick=function(){toggleSettings("enableWheretocredit")},document.getElementById("mptacEdition").onclick=function(){toggleSettings("acEdition")},document.getElementById("mptaaEdition").onclick=function(){toggleSettings("aaEdition")}}function toggleSettingsvis(){var e=document.getElementById("mptSettings");hasClass(e,"vis")?(e.setAttribute("class","invis"),e.style.display="none"):(e.setAttribute("class","vis"),e.style.display="block")}function toggleSettings(e){switch(e){case"timeformat":"12h"==mptUsersettings.timeformat?mptUsersettings.timeformat="24h":mptUsersettings.timeformat="12h";break;case"language":"de"==mptUsersettings.language?mptUsersettings.language="en":mptUsersettings.language="de";break;case"acEdition":acEditions.indexOf(mptUsersettings.acEdition)==acEditions.length-1?mptUsersettings.acEdition=acEditions[0]:mptUsersettings.acEdition=acEditions[acEditions.indexOf(mptUsersettings.acEdition)+1];break;case"aaEdition":var t=findPositionForValue(mptUsersettings.aaEdition,aaEditions);t>=aaEditions.length-1||-1===t?mptUsersettings.aaEdition=aaEditions[0].value:(t++,mptUsersettings.aaEdition=aaEditions[t].value);break;default:1==mptUsersettings[e]?mptUsersettings[e]=0:mptUsersettings[e]=1}document.getElementById("mpt"+e).firstChild.nextSibling.innerHTML=printSettingsvalue(e),1===mptSettings.scriptEngine&&GM_setValue("mptUsersettings",JSON.stringify(mptUsersettings))}function printSettingsvalue(e){var t="";switch(e){case"timeformat":t=mptUsersettings.timeformat;break;case"language":t=mptUsersettings.language;break;case"acEdition":t=mptUsersettings.acEdition;break;case"aaEdition":t=findNameForValue(mptUsersettings.aaEdition,aaEditions);break;default:t=boolToEnabled(mptUsersettings[e])}return t}function findNameForValue(e,t){var n="Unknown";for(var i in t)if(t[i].value==e){n=t[i].name;break}return n}function findPositionForValue(e,t){var n=-1;for(var i in t)if(t[i].value==e){n=[i];break}return n}function printNotification(e){var t=document.getElementById("mtpNotification");if(null===t)alert("mtp Error: Notification container not Found");else if("empty"==e)t.innerHTML="";else{var n=document.createElement("div");n.appendChild(document.createTextNode(e)),t.appendChild(n)}}function getPageLang(){printNotification("empty"),mptSettings.itaLanguage="en",mptSettings.retrycount=1,-1!=window.location.href.indexOf("view-details")?setTimeout(function(){fePS()},200):(-1!=window.location.href.indexOf("#search:")||"https://matrix.itasoftware.com/"==window.location.href||"https://matrix.itasoftware.com/"==window.location.href)&&setTimeout(function(){startPage()},200)}function exRE(e,t){for(var n,i=new Array,r=0;null!=(n=t.exec(e));)for(n.index===t.lastIndex&&t.lastIndex++,k=1;k<n.length;k++)i[r++]=n[k];return i}function inArray(e,t){for(var n=t.length,i=0;n>i;i++)if(t[i]==e)return!0;return!1}function monthnameToNumber(e){var t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return t.indexOf(e.toUpperCase())+1}function monthnumberToName(e){var t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return t[e-1]}function getFlightYear(e,t){var n=new Date,i=n.getMonth(),r=n.getDate(),a=n.getFullYear();return(i>t-1||i==t-1&&r>e)&&(a+=1),a}function return12htime(e){var t=/([01]?\d)(:\d{2})(AM|PM|am|pm| AM| PM| am| pm)/g;e=t.exec(e);var n=0;return e[3]=trimStr(e[3]),"AM"!=e[3]&&"am"!=e[3]||"12"!=e[1]?"PM"!=e[3]&&"pm"!=e[3]||"12"==e[1]||(n=12):n=-12,+e[1]+n+e[2]}function trimStr(e){return e.replace(/^\s+|\s+$/gm,"")}function boolToEnabled(e){return 1==e?"enabled":"disabled"}function getcabincode(e){switch(e){case"E":e=0;break;case"P":e=1;break;case"B":e=2;break;case"F":e=3;break;default:e=0}return e}function findtarget(e,t){var n,i=document.getElementsByTagName("*");j=0;for(n in i)if((" "+i[n].className+" ").indexOf(" "+e+" ")>-1&&(j++,j==t))return i[n]}function findtargets(e){var t,n=document.getElementsByTagName("*"),i=new Array;for(t in n)(" "+n[t].className+" ").indexOf(" "+e+" ")>-1&&i.push(n[t]);return i}function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function doHttpRequest(e,t){if("function"!=typeof t)return printNotification("Error: Invalid callback in doHttpRequest -> not a function"),!1;var n=!1;return"undefined"!=typeof XMLHttpRequest&&(n=new XMLHttpRequest),n?(n.onreadystatechange=function(){if(4==n.readyState&&200==n.status)t(n);else if(4==n.readyState&&200!=n.status)return printNotification("Error: Failed to complete http request"),!1},n.open("GET",e,!0),void n.send()):(printNotification("Error: Failed to initialize http request"),!1)}function findItinTarget(e,t,n){var r=findtarget(classSettings.resultpage.itin,1);if(r===!1)return printNotification("Error: Itin not found in findItinTarget-function"),!1;r=r.nextSibling.nextSibling;var r=r.children[e-1];if(void 0===r)return printNotification("Error: Leg not found in findItinTarget-function"),!1;if(r=r.children[1].children,r.length>=2){var a=0,s=0;for(i=0;i<r.length;i++)if(1==hasClass(r[i],classSettings.resultpage.itinRow)&&(s++,s>=t)){a=i,(2===r.length||3===r.length)&&a--;break}if(i==r.length)return printNotification("Error: Call to unreachable Segment in Leg "+e+" in findItinTarget-function"),!1;var o=0,l=0;switch(n){case"headline":o=-1*a,l=1;break;case"logo":o=0,l=0;break;case"airportsdate":o=0,l=1;break;case"flight":o=1,l=0;break;case"deptime":o=1,l=1;break;case"arrtime":o=1,l=2;break;case"duration":o=1,l=2;break;case"plane":o=1,l=4;break;case"cabin":o=1,l=5;break;default:return printNotification("Error: Unknown Target in findItinTarget-function"),!1}return r[a+o].children[l]}return printNotification("Error: Unknown error in findItinTarget-function"),!1}function startPage(){return void 0===findtarget(classSettings.startpage.maindiv,1)?(printNotification("Error: Unable to find content on start page."),!1):(target=findtarget(classSettings.startpage.maindiv,1),void target.children[0].children[0].children[0].children[0].setAttribute("valign","top"))}function fePS(){if(void 0===findtarget(classSettings.resultpage.itin,1))return printNotification("Error: Unable to find Content on result page."),!1;if("none"!=findtarget(classSettings.resultpage.itin,1).parentNode.previousSibling.previousSibling.style.display)return mptSettings.retrycount++,mptSettings.retrycount>50?(printNotification("Error: Timeout on result page. Content not found after 10s."),!1):(setTimeout(function(){fePS()},200),!1);for(n in classSettings.resultpage)if(void 0===findtarget(classSettings.resultpage[n],1))return printNotification("Error: Unable to find class "+classSettings.resultpage[n]+" for "+n+"."),!1;if(1==mptUsersettings.enableFarerules&&bindRulelinks(),void 0!=document.getElementById("powertoolslinkcontainer")){var e=document.getElementById("powertoolslinkcontainer");e.innerHTML=""}for(var t=findtargets("powertoolsitem"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n]);1==mptUsersettings.enableInlinemode?findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",10):0==mptUsersettings.enableInlinemode&&1==mptUsersettings.enablePricebreakdown?findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",3):findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",2),readItinerary(),"en"!==mptUsersettings.language&&void 0!==translations[mptUsersettings.language].resultpage&&translate("resultpage",mptUsersettings.language,findtarget(classSettings.resultpage.itin,1).nextSibling.nextSibling);var i=findtarget("pricebreakdown",1);void 0!=i&&i.parentNode.removeChild(i),1==mptUsersettings.enablePricebreakdown&&rearrangeprices(currentItin.dist),1==mptUsersettings.enableInlinemode&&printCPM(),printAA(),printAC(),2==currentItin.itin.length&&currentItin.itin[0].orig==currentItin.itin[1].dest&&currentItin.itin[0].dest==currentItin.itin[1].orig&&printAF(),1==currentItin.carriers.length&&"AZ"==currentItin.carriers[0]&&printAZ(),printDelta(),printKL(),1==currentItin.carriers.length&&"US"==currentItin.carriers[0]&&printUS(),1==mptUsersettings.enableDeviders&&printSeperator(),printCheapOair(),printOrbitz(),printHipmunk(),printPriceline(),printEtraveli(),1==mptUsersettings.enableDeviders&&printSeperator(),printFarefreaks(0),printFarefreaks(1),printGCM(),printWheretocredit(),1==mptUsersettings.enableSeatguru&&bindSeatguru(),1==mptUsersettings.enablePlanefinder&&bindPlanefinder(),1==mptUsersettings.enableMilesbreakdown&&"undefined"!=typeof JSON&&printMilesbreakdown(),1==mptUsersettings.enableWheretocredit&&bindWheretocredit()}function bindRulelinks(){var e=0,t=0,n=1,i=findtarget(classSettings.resultpage.rulescontainer,n);if(void 0!=i)do{var r=Number(i.firstChild.innerHTML.replace(/[^\d]/gi,""));e>r&&(t++,e=0),i=i.nextSibling.nextSibling.nextSibling;var a=window.location.href.replace(/view-details/,"view-rules")+";fare-key="+t+"/"+e,s=document.createElement("a");s.setAttribute("class","gwt-Anchor"),s.setAttribute("href",a),s.setAttribute("target","_blank");var o=document.createTextNode("rules");s.appendChild(o),i.parentNode.replaceChild(s,i),e++,n++,i=findtarget(classSettings.resultpage.rulescontainer,n)}while(void 0!=i)}function rearrangeprices(){var e=0,t=0,n=0,i=0,r="",a=new RegExp("((YQ|YR))"),s=1,o=findtarget(classSettings.resultpage.htbLeft,s);if(0==mptUsersettings.enableInlinemode)var l="",g=0;if(void 0!=o)do{var d=o.firstChild.firstChild.nodeType;if(1==d){i=1;var c=Number(o.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));""==r&&(r=o.nextSibling.firstChild.innerHTML.replace(/[\d,.]/g,"")),e+=c}else if(1==i&&3==d){var u=o.firstChild.innerHTML,c=Number(o.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));if(1==hasClass(o.nextSibling,classSettings.resultpage.htbGreyBorder)){var p=e+t+n;if(1==mptUsersettings.enableInlinemode){var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Basefare per passenger ('+(e/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbGreyBorder+'"><div class="gwt-Label">'+r+(e/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Taxes per passenger ('+(t/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbRight+'"><div class="gwt-Label">'+r+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Surcharges per passenger ('+(n/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbRight+'"><div class="gwt-Label">'+r+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Basefare + Taxes per passenger ('+((e+t)/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbGreyBorder+'"><div class="gwt-Label">'+r+((e+t)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode)}else g++,l+='<table style="float:left; margin-right:15px;"><tbody>',l+='<tr><td colspan=3 style="text-align:center;">Price breakdown '+g+":</td></tr>",l+="<tr><td>"+r+' per mile</td><td colspan=2 style="text-align:center;">'+(p/currentItin.dist/100).toFixed(4).toString()+"</td></tr>",l+='<tr><td>Basefare</td><td style="padding:0px 3px;text-align:right;">'+(e/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(e/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td>Tax</td><td style="padding:0px 3px;text-align:right;">'+(t/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td>Surcharges</td><td style="padding:0px 3px;text-align:right;">'+(n/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td style="border-top: 1px solid #878787;padding:2px 0">Bf+Tax</td><td style="border-top: 1px solid #878787;padding:2px 3px;text-align:right;">'+((e+t)/p*100).toFixed(1).toString()+'%</td><td style="border-top: 1px solid #878787;padding:2px 0; text-align:right;">'+r+((e+t)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+="</tbody></table>";currentItin.basefares=+(e/100).toFixed(2),currentItin.taxes=+(t/100).toFixed(2),currentItin.surcharges=+(n/100).toFixed(2),i=0,e=0,t=0,n=0}else a.test(u)===!0?n+=c:t+=c}s++,o=findtarget(classSettings.resultpage.htbLeft,s)}while(void 0!=o);if(0==mptUsersettings.enableInlinemode){var I=findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode,m=document.createElement("tr");m.setAttribute("class","pricebreakdown"),m.innerHTML="<td><div>"+l+"</div></td>",I.parentNode.insertBefore(m,I)}}function printMilesbreakdown(){1==mptUsersettings.enableMilesbreakdownautoload?retrieveMileages():(target=findItinTarget(1,1,"headline"),target.innerHTML=target.innerHTML.replace(target.firstChild.className,target.firstChild.className+'" style="display:inline-block')+'<div id="loadmileage" class="'+target.firstChild.className+'" style="display:inline-block;cursor:pointer;float:right;">Load mileage</div>',document.getElementById("loadmileage").onclick=function(){document.getElementById("loadmileage").parentNode.removeChild(document.getElementById("loadmileage")),retrieveMileages()})}function retrieveMileages(){for(var e=new Object,t="",n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)void 0===distances[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]&&void 0===distances[currentItin.itin[n].seg[i].dest+currentItin.itin[n].seg[i].orig]&&void 0===e[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]&&void 0===e[currentItin.itin[n].seg[i].dest+currentItin.itin[n].seg[i].orig]&&(e[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]=currentItin.itin[n].seg[i].orig+"-"+currentItin.itin[n].seg[i].dest);for(n in e)t+=(""===t?"":"&")+"r[]="+e[n];return""===t?(printMileages(),!1):void doHttpRequest("https://www.farefreaks.com/ajax/calcroutedist.php?"+t,function(e){var t=!1;if("undefined"==typeof JSON)return printNotification("Error: Failed parsing route data - Browser not supporting JSON"),!1;try{t=JSON.parse(e.responseText)}catch(i){t=!1}if("object"!=typeof t)return printNotification("Error: Failed parsing route data"),!1;if(void 0===t.success||void 0===t.error||void 0===t.data)return printNotification("Error: wrong route data format"),!1;if("1"!==t.success)return printNotification("Error: "+t.error+" in retrieveMileages function"),!1;for(n in t.data)distances[n]=parseFloat(t.data[n]);printMileages()})}function printMileages(){for(var e=0,t=0;t<currentItin.itin.length;t++){for(var n=0;n<currentItin.itin[t].seg.length;n++){if(void 0===distances[currentItin.itin[t].seg[n].orig+currentItin.itin[t].seg[n].dest]&&void 0===distances[currentItin.itin[t].seg[n].dest+currentItin.itin[t].seg[n].orig])return printNotification("Error: Missing route data for "+currentItin.itin[t].seg[n].orig+" => "+currentItin.itin[t].seg[n].dest),!1;void 0!==distances[currentItin.itin[t].seg[n].orig+currentItin.itin[t].seg[n].dest]&&void 0===distances[currentItin.itin[t].seg[n].dest+currentItin.itin[t].seg[n].orig]?currentItin.itin[t].seg[n].dist=distances[currentItin.itin[t].seg[n].orig+currentItin.itin[t].seg[n].dest]:currentItin.itin[t].seg[n].dist=distances[currentItin.itin[t].seg[n].dest+currentItin.itin[t].seg[n].orig],e+=currentItin.itin[t].seg[n].dist,currentItin.itin[t].seg[n].dist=Math.floor(currentItin.itin[t].seg[n].dist)}currentItin.itin[t].dist=Math.floor(e),e=0}if(1===mptUsersettings.enableInlinemode||1===mptUsersettings.enableMilesInlinemode)for(var i="",t=0;t<currentItin.itin.length;t++){i=findItinTarget(t+1,1,"headline"),i.innerHTML=i.innerHTML.replace(i.firstChild.className,i.firstChild.className+'" style="display:inline-block')+'<div style="display:inline-block;float:right;"> '+currentItin.itin[t].dist+" miles</div>";for(var n=0;n<currentItin.itin[t].seg.length;n++)currentItin.itin[t].seg.length>1&&(i=findItinTarget(t+1,n+1,"airportsdate"),i.innerHTML=i.innerHTML.replace(i.firstChild.className,i.firstChild.className+'" style="display:inline-block')+'<div style="display:inline-block;float:right;margin-right:110px;"> '+currentItin.itin[t].seg[n].dist+" miles</div>")}else{var r="";r+="<tbody>",r+='<tr><td colspan="4" style="text-align:center;">Mileage breakdown:</td></tr>';for(var t=0;t<currentItin.itin.length;t++){r+='<tr><td style="border-bottom: 1px solid #878787;padding:2px 2px">Leg '+(t+1)+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0">'+currentItin.itin[t].orig+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0">'+currentItin.itin[t].dest+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0;text-align:right;">'+currentItin.itin[t].dist+"</td></tr>";for(var n=0;n<currentItin.itin[t].seg.length;n++)currentItin.itin[t].seg.length>1&&(r+="<tr><td></td><td>"+currentItin.itin[t].seg[n].orig+"</td><td>"+currentItin.itin[t].seg[n].dest+'</td><td style="text-align:right;">'+currentItin.itin[t].seg[n].dist+"</td></tr>")}if(r+="</tbody>",void 0===findtarget("pricebreakdown",1)){var a=findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode,s=document.createElement("tr");s.setAttribute("class","pricebreakdown"),s.innerHTML='<td><div><table style="float:left; margin-right:15px;">'+r+"</table></div></td>",a.parentNode.insertBefore(s,a)}else{var a=findtarget("pricebreakdown",1).firstChild.firstChild.firstChild,o=document.createElement("table");o.setAttribute("style","float:left; margin-right:15px;"),o.innerHTML=r,a.parentNode.insertBefore(o,a)}}}function parseAddInfo(e){var t={codeshare:0,layoverduration:0,airportchange:0,arrDate:""};-1==e.indexOf("This flight contains airport changes")&&(airportchange=1),-1==e.indexOf("OPERATED BY")&&(codeshare=1);var n=new Array,i=/\,\s*([a-zA-Z]{3})\s*([0-9]{1,2})/g;n=exRE(e,i),2==n.length&&(t.arrDate={},t.arrDate.month=monthnameToNumber(n[0]),t.arrDate.day=parseInt(n[1]),t.arrDate.year=getFlightYear(t.arrDate.day,t.arrDate.month));var n=new Array,i=/([0-9]{1,2})h\s([0-9]{1,2})m/g;return n=exRE(e,i),2==n.length&&(t.layoverduration=60*parseInt(n[0])+parseInt(n[1])),t}function readItinerary(){var e=new Array,t=new Array,n=new Array,i=new Array,r=document.getElementById("contentwrapper").innerHTML,a=/colspan\=\"5\"[^\(]+\(([\w]{3})[^\(]+\(([\w]{3})/g;for(legs=exRE(r,a),d=0;d<legs.length;d+=2){var s={};s.arr={},s.dep={},s.orig=legs[d],s.dest=legs[d+1],s.seg=new Array,n.push(s)}var o=new Array,a=/Carrier\s[\w]{2}\s([\w]+).*?Covers\s([\w\(\)\s\-,]+)/g;o=exRE(r,a);var l={fares:new Array,legs:new Array};for(d=0;d<o.length;d+=2)l.fares.push(o[d]),l.legs.push(exRE(o[d+1],/(\w\w\w\-\w\w\w)/g));for(var g=new Array,d=0;d<l.legs.length;d++)for(var c=0;c<l.legs[d].length;c++)g.push(l.legs[d][c]+"-"+l.fares[d]);var u=new Array,a=/35px\/(\w{2}).png[^\(]+\(([A-Z]{3})[^\(]+\(([A-Z]{3})[^\,]*\,\s*([a-zA-Z]{3})\s*([0-9]{1,2}).*?gwt-Label.*?([0-9]*)\<.*?Dep:[^0-9]+(.*?)\<.*?Arr:[^0-9]+(.*?)\<.*?([0-9]{1,2})h\s([0-9]{1,2})m.*?gwt-Label.*?\<.*?gwt-Label\"\>(\w).*?\((\w)\).*?\<.*?tr(.*?)(table|airline_logos)/g;u=exRE(r,a);var p=0,m=0;for(d=0;d<u.length;d+=14){temp={},temp.carrier=u[d],temp.orig=u[d+1],temp.dest=u[d+2],temp.dep={},temp.arr={},temp.dep.month=monthnameToNumber(u[d+3]),temp.dep.day=parseInt(u[d+4]),temp.dep.year=getFlightYear(temp.dep.day,temp.dep.month),temp.fnr=u[d+5],"24h"==mptUsersettings.timeformat&&(e.push(u[d+6]),e.push(u[d+7])),u[d+6]=return12htime(u[d+6]),u[d+7]=return12htime(u[d+7]),"24h"==mptUsersettings.timeformat&&(t.push((4==u[d+6].length?"0":"")+u[d+6]),t.push((4==u[d+7].length?"0":"")+u[d+7])),temp.dep.time=u[d+6],temp.arr.time=u[d+7],temp.duration=60*parseInt(u[d+8])+parseInt(u[d+9]),temp.cabin=getcabincode(u[d+10]),temp.bookingclass=u[d+11];var I=parseAddInfo(u[d+12]);""!=I.arrDate?(temp.arr.day=I.arrDate.day,temp.arr.month=I.arrDate.month,temp.arr.year=I.arrDate.year):(temp.arr.day=temp.dep.day,temp.arr.month=temp.dep.month,temp.arr.year=temp.dep.year),temp.codeshare=I.codeshare,temp.layoverduration=I.layoverduration,temp.airportchange=I.airportchange;for(var c=0;c<g.length;c++)-1!=g[c].indexOf(temp.orig+"-"+temp.dest+"-")&&(temp.farebase=g[c].replace(temp.orig+"-"+temp.dest+"-",""),g[c]=temp.farebase,c=g.length);void 0===n[p]&&(n[p]=new Object),void 0===n[p].seg&&(n[p].seg=new Array),n[p].seg.push(temp),inArray(temp.carrier,i)||i.push(temp.carrier),0==m&&(void 0===n[p].dep&&(n[p].dep=new Object),n[p].dep.day=temp.dep.day,n[p].dep.month=temp.dep.month,n[p].dep.year=temp.dep.year,n[p].dep.time=temp.dep.time),void 0===n[p].arr&&(n[p].arr=new Object),n[p].arr.day=temp.arr.day,n[p].arr.month=temp.arr.month,n[p].arr.year=temp.arr.year,n[p].arr.time=temp.arr.time,m++,"table"==u[d+13]&&(p++,m=0)}var h=new Array,a=/Mileage.*?([0-9,]+)\stotal\smiles.*?Total\scost\sfor\s([0-9])\spassenger.*?<div.*?([0-9,.]+)/g;h=exRE(r,a),itinCur="";var a=/Total\scost\sfor\s[0-9]\spassenger([^0-9]+[^\<]+)/g,f=new Array;f=exRE(r,a),f=f[0].replace(/<[^>]+>/g,"");var b=/\â‚¬/;b.test(f)===!0&&(itinCur="EUR");var b=/US\$/;if(b.test(f)===!0&&(itinCur="USD"),currentItin={itin:n,price:h[2].replace(/\,/g,""),numPax:h[1],carriers:i,cur:itinCur,farebases:l.fares,dist:h[0].replace(/\./g,"").replace(/\,/g,"")},e.length>0)for(target=findtarget(classSettings.resultpage.itin,1).nextSibling.nextSibling,d=0;d<e.length;d++)a=new RegExp(e[d],"g"),target.innerHTML=target.innerHTML.replace(a,t[d])}function translate(e,t,n){if(void 0===translations[t])return printNotification("Error: Translation "+t+" not found"),!1;if(void 0===translations[t][e])return printNotification("Error: Translation "+t+" not found for page "+e),!1;for(i in translations[t][e])re=new RegExp(i,"g"),n.innerHTML=n.innerHTML.replace(re,translations[t][e][i])}function printCPM(){printItemInline((Number(currentItin.price)/Number(currentItin.dist)).toFixed(4)+" cpm","",1)}function printAA(){var e=function(e){for(var t="http://i11l-services.aa.com/xaa/mseGateway/entryPoint.php?PARAM=",n="1,,USD0.00,"+currentItin.itin.length+",",i=new Array,r="",a=new Array,s="",o=0;o<currentItin.itin.length;o++){a=new Array;for(var l=0;l<currentItin.itin[o].seg.length;l++){for(var g=0;l+g<currentItin.itin[o].seg.length-1&&!(currentItin.itin[o].seg[l+g].fnr!=currentItin.itin[o].seg[l+g+1].fnr||currentItin.itin[o].seg[l+g].layoverduration>=1440);)g++;s=currentItin.itin[o].seg[l+g].arr.year+"-"+("0"+currentItin.itin[o].seg[l+g].arr.month).slice(-2)+"-"+("0"+currentItin.itin[o].seg[l+g].arr.day).slice(-2)+"T"+("0"+currentItin.itin[o].seg[l+g].arr.time).slice(-5)+"+00:00,",s+=currentItin.itin[o].seg[l].bookingclass+",",s+=currentItin.itin[o].seg[l].dep.year+"-"+("0"+currentItin.itin[o].seg[l].dep.month).slice(-2)+"-"+("0"+currentItin.itin[o].seg[l].dep.day).slice(-2)+"T"+("0"+currentItin.itin[o].seg[l].dep.time).slice(-5)+"+00:00,",s+=currentItin.itin[o].seg[l+g].dest+",",s+=currentItin.itin[o].seg[l].carrier+currentItin.itin[o].seg[l].fnr+",",s+=currentItin.itin[o].seg[l].orig,a.push(s),l+=g}n+=a.length+","+a.join()+",",r=currentItin.itin[o].dep.year+"-"+("0"+currentItin.itin[o].dep.month).slice(-2)+"-"+("0"+currentItin.itin[o].dep.day).slice(-2)+",",r+=currentItin.itin[o].dest+",,",r+=currentItin.itin[o].orig+",",i.push(r)}return n+="DIRECT,",n+=e[0].toUpperCase()+",",n+="3,",n+=currentItin.numPax+",",n+="0,",n+="0,",n+="0,",n+=e[1].toUpperCase()+",",n+=currentItin.itin.length+","+i.join(),t+=encodeURIComponent(n)},t=mptUsersettings.aaEdition.split("_");if(2!=t.length)return printNotification("Error:Invalid AA-Edition"),!1;var n=e(t),i=' <span class="pt-hover-container">[+]<span class="pt-hover-menu">';i+=aaEditions.map(function(t,n){return'<a href="'+e(t.value.split("_"))+'" target="_blank">'+t.name+"</a>"}).join("<br/>"),i+="</span></span>",1==mptUsersettings.enableInlinemode?printUrlInline(n,"American","",null,i):printUrl(n,"American","",i)}function printAC(){var e=function(e){var t="http://www.aircanada.com/aco/flights.do?AH_IATA_NUMBER=0005118&AVAIL_EMMBEDDED_TRANSACTION=FlexPricerAvailabilityServlet";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"&country=DE&countryOfResidence=DE&language=de&LANGUAGE=DE":"&country="+e+"&countryofResidence="+e+"&language=en&LANGUAGE=US",t+="&CREATION_MODE=30&EMBEDDED_TRANSACTION=FareServelet&FareRequest=YES&fromThirdParty=YES&HAS_INFANT_1=False&IS_PRIMARY_TRAVELLER_1=True&SITE=SAADSAAD&thirdPartyID=0005118&TRAVELER_TYPE_1=ADT&PRICING_MODE=0",t+="&numberOfChildren=0&numberOfInfants=0&numberOfYouth=0&numberOfAdults="+currentItin.numPax,t+="&tripType="+(currentItin.itin.length>1?"R":"O");for(var n=0;n<currentItin.itin.length;n++){0==n?t+="&departure1="+("0"+currentItin.itin[n].dep.day).slice(-2)+"/"+("0"+currentItin.itin[n].dep.month).slice(-2)+"/"+currentItin.itin[n].dep.year+"&org1="+currentItin.itin[n].orig+"&dest1="+currentItin.itin[n].dest:1==n&&(t+="&departure2="+("0"+currentItin.itin[n].dep.day).slice(-2)+"/"+("0"+currentItin.itin[n].dep.month).slice(-2)+"/"+currentItin.itin[n].dep.year);for(var i=0;i<currentItin.itin[n].seg.length;i++)t+="&AIRLINE_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].carrier,t+="&B_DATE_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].dep.year+("0"+currentItin.itin[n].seg[i].dep.month).slice(-2)+("0"+currentItin.itin[n].seg[i].dep.day).slice(-2)+("0"+currentItin.itin[n].seg[i].dep.time.replace(":","")).slice(-4),t+="&B_LOCATION_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].orig,t+="&E_DATE_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].arr.year+("0"+currentItin.itin[n].seg[i].arr.month).slice(-2)+("0"+currentItin.itin[n].seg[i].arr.day).slice(-2)+("0"+currentItin.itin[n].seg[i].arr.time.replace(":","")).slice(-4),t+="&E_LOCATION_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].dest,t+="&FLIGHT_NUMBER_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].fnr,t+="&RBD_"+(n+1)+"_"+(i+1)+"="+currentItin.itin[n].seg[i].bookingclass}return t},t=e(mptUsersettings.acEdition.toUpperCase()),n=' <span class="pt-hover-container">[+]<span class="pt-hover-menu">';n+=acEditions.map(function(t,n){return'<a href="'+e(t.toUpperCase())+'" target="_blank">'+t+"</a>"}).join("<br/>"),n+="</span></span>",1==mptUsersettings.enableInlinemode?printUrlInline(t,"Air Canada","",null,n):printUrl(t,"Air Canada","",n)}function printAF(){var e="https://www.airfrance.com/",t="";e+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"DE/de":"US/en",e+="/local/process/standardbooking/DisplayUpsellAction.do?cabin=Y&calendarSearch=1&listPaxTypo=ADT&subCabin=MCHER&typeTrip=2",e+="&nbPax="+currentItin.numPax;for(var n=0;n<currentItin.itin.length;n++)if(0==n){e+="&from="+currentItin.itin[n].orig,e+="&to="+currentItin.itin[n].dest,e+="&outboundDate="+currentItin.itin[n].dep.year+"-"+("0"+currentItin.itin[n].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].dep.day).slice(-2),
e+="&firstOutboundHour="+("0"+currentItin.itin[n].dep.time).slice(-5),t="";for(var i=0;i<currentItin.itin[n].seg.length;i++)i>0&&(t+="|"),t+=currentItin.itin[n].seg[i].carrier+("000"+currentItin.itin[n].seg[i].fnr).slice(-4);e+="&flightOutbound="+t}else if(1==n){e+="&inboundDate="+currentItin.itin[n].dep.year+"-"+("0"+currentItin.itin[n].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].dep.day).slice(-2),e+="&firstInboundHour="+("0"+currentItin.itin[n].dep.time).slice(-5),t="";for(var i=0;i<currentItin.itin[n].seg.length;i++)i>0&&(t+="|"),t+=currentItin.itin[n].seg[i].carrier+("000"+currentItin.itin[n].seg[i].fnr).slice(-4);e+="&flightInbound="+t}1==mptUsersettings.enableInlinemode?printUrlInline(e,"Air France",""):printUrl(e,"Air France","")}function printAZ(){var e="http://booking.alitalia.com/Booking/"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de":"us_en")+"/Flight/ExtMetaSearch?SearchType=BrandMetasearch";e+="&children_number=0&Children=0&newborn_number=0&Infants=0",e+="&adult_number="+currentItin.numPax+"&Adults="+currentItin.numPax;for(var t=0,n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)e+="&MetaSearchDestinations["+t+"].From="+currentItin.itin[n].seg[i].orig,e+="&MetaSearchDestinations["+t+"].to="+currentItin.itin[n].seg[i].dest,e+="&MetaSearchDestinations["+t+"].DepartureDate="+currentItin.itin[n].seg[i].dep.year+"-"+("0"+currentItin.itin[n].seg[i].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].seg[i].dep.day).slice(-2),e+="&MetaSearchDestinations["+t+"].Flight="+currentItin.itin[n].seg[i].fnr,e+="&MetaSearchDestinations["+t+"].code="+currentItin.itin[n].seg[i].farebase,e+="&MetaSearchDestinations["+t+"].slices="+n,t++;1==mptUsersettings.enableInlinemode?printUrlInline(e,"Alitalia",""):printUrl(e,"Alitalia","")}function getDeltaCabin(e){switch(e){case 2:e="B2-Business";break;case 3:e="B2-Business";break;default:e="B5-Coach"}return e}function printDelta(){var e="http://"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de":"www");e+=".delta.com/booking/priceItin.do?dispatchMethod=priceItin&tripType=multiCity&cabin=B5-Coach",e+="&currencyCd="+("EUR"==currentItin.cur?"EUR":"USD")+"&exitCountry="+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language,"US");for(var t=0,n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)e+="&itinSegment["+t.toString()+"]="+n.toString()+":"+currentItin.itin[n].seg[i].bookingclass,e+=":"+currentItin.itin[n].seg[i].orig+":"+currentItin.itin[n].seg[i].dest+":"+currentItin.itin[n].seg[i].carrier+":"+currentItin.itin[n].seg[i].fnr,e+=":"+monthnumberToName(currentItin.itin[n].seg[i].dep.month)+":"+(currentItin.itin[n].seg[i].dep.day<10?"0":"")+currentItin.itin[n].seg[i].dep.day+":"+currentItin.itin[n].seg[i].dep.year+":0",t++;e+="&fareBasis="+currentItin.farebases.toString().replace(/,/g,":"),e+="&price=0",e+="&numOfSegments="+t.toString()+"&paxCount="+currentItin.numPax,e+="&vendorRedirectFlag=true&vendorID=Google",1==mptUsersettings.enableInlinemode?printUrlInline(e,"Delta",""):printUrl(e,"Delta","")}function printKL(){var e="https://www.klm.com/travel/";e+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de/apps/ebt/ebt_home.htm?lang=DE":"us_en/apps/ebt/ebt_home.htm?lang=EN",e+="&chdQty=0&infQty=0&dev=5&cffcc=ECONOMY";var t="",n="";e+="&adtQty="+currentItin.numPax;for(var i=0;i<currentItin.itin.length;i++){e+="&c["+i+"].os="+currentItin.itin[i].orig,e+="&c["+i+"].ds="+currentItin.itin[i].dest,e+="&c["+i+"].dd="+currentItin.itin[i].dep.year+"-"+("0"+currentItin.itin[i].dep.month).slice(-2)+"-"+("0"+currentItin.itin[i].dep.day).slice(-2),i>0&&(n+="..");for(var r=0;r<currentItin.itin[i].seg.length;r++)e+="&c["+i+"].s["+r+"].os="+currentItin.itin[i].seg[r].orig,e+="&c["+i+"].s["+r+"].ds="+currentItin.itin[i].seg[r].dest,e+="&c["+i+"].s["+r+"].dd="+currentItin.itin[i].seg[r].dep.year+"-"+("0"+currentItin.itin[i].seg[r].dep.month).slice(-2)+"-"+("0"+currentItin.itin[i].seg[r].dep.day).slice(-2),e+="&c["+i+"].s["+r+"].dt="+("0"+currentItin.itin[i].seg[r].dep.time.replace(":","")).slice(-4),e+="&c["+i+"].s["+r+"].mc="+currentItin.itin[i].seg[r].carrier,e+="&c["+i+"].s["+r+"].fn="+("000"+currentItin.itin[i].seg[r].fnr).slice(-4),r>0&&(n+="."),n+=currentItin.itin[i].seg[r].carrier}for(var i=0;i<currentItin.farebases.length;i++)i>0&&(t+=","),t+=currentItin.farebases[i];e+="&ref=fb="+t,1==mptUsersettings.enableInlinemode?printUrlInline(e,"KLM",""):printUrl(e,"KLM","")}function getUSCabin(e){switch(e){case 2:e="B";break;case 3:e="F";break;default:e="C"}return e}function printUS(){var e="https://shopping.usairways.com/Flights/Passenger.aspx?g=goo&c=goog_US_pax";e+="&a="+currentItin.numPax,e+="&s="+getUSCabin(currentItin.itin[0].seg[0].cabin).toLowerCase();for(var t=0;t<currentItin.itin.length;t++)for(var n=0;n<currentItin.itin[t].seg.length;n++){var i=(t+1).toString()+(n+1).toString();e+="&o"+i+"="+currentItin.itin[t].seg[n].orig+"&d"+i+"="+currentItin.itin[t].seg[n].dest+"&f"+i+"="+currentItin.itin[t].seg[n].fnr,e+="&t"+i+"="+currentItin.itin[t].seg[n].dep.year+(currentItin.itin[t].seg[n].dep.month<10?"0":"")+currentItin.itin[t].seg[n].dep.month+(currentItin.itin[t].seg[n].dep.day<10?"0":"")+currentItin.itin[t].seg[n].dep.day+"0000",e+="&x"+i+"="+currentItin.itin[t].seg[n].farebase}1==mptUsersettings.enableInlinemode?printUrlInline(e,"US Airways",""):printUrl(e,"US Airways","")}function printCheapOair(){var e=["Economy","PREMIUMECONOMY","Business","First"],t="http://www.cheapoair.com/default.aspx?tabid=1832&ch=0&sr=0&is=0&il=0&ulang=en";t+="&ad="+currentItin.numPax;for(var n=0,i={},r=0;r<currentItin.itin.length;r++){i[r]="";for(var a=0;a<currentItin.itin[r].seg.length;a++)n++,i[r]&&(i[r]+=","),i[r]+=n,t+="&cbn"+n+"="+e[currentItin.itin[r].seg[a].cabin],t+="&carr"+n+"="+currentItin.itin[r].seg[a].carrier,t+="&dd"+n+"="+currentItin.itin[r].seg[a].dep.year+("0"+currentItin.itin[r].seg[a].dep.month).slice(-2)+("0"+currentItin.itin[r].seg[a].dep.day).slice(-2),t+="&og"+n+"="+currentItin.itin[r].seg[a].orig,t+="&dt"+n+"="+currentItin.itin[r].seg[a].dest,t+="&fbc"+n+"="+currentItin.itin[r].seg[a].bookingclass,t+="&fnum"+n+"="+currentItin.itin[r].seg[a].fnr;t+="&Slice"+(r+1)+"="+i[r]}t+=1==currentItin.itin.length?"&tt=OneWay":2==currentItin.itin.length&&currentItin.itin[0].orig==currentItin.itin[1].dest&&currentItin.itin[0].dest==currentItin.itin[1].orig?"&tt=RoundTrip":"&tt=MultiCity",1==mptUsersettings.enableInlinemode?printUrlInline(t,"CheapOair",""):printUrl(t,"CheapOair","")}function getHipmunkCabin(e){switch(e){case 2:e="Business";break;case 3:e="First";break;default:e="Coach"}return e}function printHipmunk(){for(var e="https://www.hipmunk.com/search/flights?",t=3,n=0;n<currentItin.itin.length;n++){e+="&from"+n+"="+currentItin.itin[n].orig;for(var i=0;i<currentItin.itin[n].seg.length;i++){for(var r=0;i+r<currentItin.itin[n].seg.length-1&&!(currentItin.itin[n].seg[i+r].fnr!=currentItin.itin[n].seg[i+r+1].fnr||currentItin.itin[n].seg[i+r].layoverduration>=1440);)r++;e+=(i>0?"%20"+currentItin.itin[n].seg[i].orig+"%20":"%3A%3A")+currentItin.itin[n].seg[i].carrier+currentItin.itin[n].seg[i].fnr,currentItin.itin[n].seg[i].cabin<t&&(t=currentItin.itin[n].seg[i].cabin),i+=r}e+="&date"+n+"="+currentItin.itin[n].dep.year+"-"+(Number(currentItin.itin[n].dep.month)<=9?"0":"")+currentItin.itin[n].dep.month.toString()+"-"+(Number(currentItin.itin[n].dep.day)<=9?"0":"")+currentItin.itin[n].dep.day.toString(),e+="&to"+n+"="+currentItin.itin[n].dest}e+="&pax="+currentItin.numPax+"&cabin="+getHipmunkCabin(t)+"&infant_lap=0&infant_seat=0&seniors=0&children=0",1==mptUsersettings.enableInlinemode?printUrlInline(e,"Hipmunk",""):printUrl(e,"Hipmunk","")}function printOrbitz(){var e=["C","E","B","F"],t=[{name:"ebookers.de",host:"www.ebookers.de",dateFormat:"dd.MM.yyyy"},{name:"ebookers.at",host:"www.ebookers.at",dateFormat:"dd.MM.yyyy"},{name:"ebookers.fi",host:"www.ebookers.fi",dateFormat:"dd.MM.yyyy"},{name:"ebookers.com",host:"www.ebookers.com",dateFormat:"dd/MM/yyyy"},{name:"ebookers.be",host:"www.ebookers.be",dateFormat:"dd/MM/yyyy"},{name:"ebookers.fr",host:"www.ebookers.fr",dateFormat:"dd/MM/yyyy"},{name:"ebookers.ie",host:"www.ebookers.ie",dateFormat:"dd/MM/yyyy"},{name:"ebookers.ch",host:"www.ebookers.ch",dateFormat:"dd/MM/yyyy"},{name:"ebookers.nl",host:"www.ebookers.nl",dateFormat:"dd-MM-yy"},{name:"ebookers.no",host:"www.ebookers.no",dateFormat:"dd.MM.yyyy"},{name:"mrjet.se",host:"www.mrjet.se",dateFormat:"yyyy-MM-dd"},{name:"mrjet.dk",host:"www.mrjet.dk",dateFormat:"dd-MM-yyyy"}],n=function(e,t){return t.replace("dd",e.day).replace("MM",e.month).replace("yyyy",e.year).replace("yy",e.year%100)},i=function(t,i){var r="",a="http://"+t+"/shop/home?type=air&source=GOOGLE_META&searchHost=ITA&ar.type=multiCity&strm=true";a+="&ar.mc.numAdult="+currentItin.numPax,a+="&ar.mc.numSenior=0&ar.mc.numChild=0&ar.mc.child[0]=&ar.mc.child[1]=&ar.mc.child[2]=&ar.mc.child[3]=&ar.mc.child[4]=&ar.mc.child[5]=&ar.mc.child[6]=&ar.mc.child[7]=&search=Search Flights&ar.mc.nonStop=true&_ar.mc.nonStop=0";for(var s=0;s<currentItin.itin.length;s++){a+="&ar.mc.slc["+s+"].orig.key="+currentItin.itin[s].orig,a+="&_ar.mc.slc["+s+"].originRadius=0",a+="&ar.mc.slc["+s+"].dest.key="+currentItin.itin[s].dest,a+="&_ar.mc.slc["+s+"].destinationRadius=0",a+="&ar.mc.slc["+s+"].date="+n(currentItin.itin[s].dep,i),a+="&ar.mc.slc["+s+"].time=Anytime";for(var o=0;o<currentItin.itin[s].seg.length;o++){for(var l=0;o+l<currentItin.itin[s].seg.length-1&&!(currentItin.itin[s].seg[o+l].fnr!=currentItin.itin[s].seg[o+l+1].fnr||currentItin.itin[s].seg[o+l].layoverduration>=1440);)l++;r+=currentItin.itin[s].seg[o].carrier+currentItin.itin[s].seg[o].fnr+currentItin.itin[s].seg[o].orig+currentItin.itin[s].seg[o+l].dest+(currentItin.itin[s].seg[o].dep.month<10?"0":"")+currentItin.itin[s].seg[o].dep.month+(currentItin.itin[s].seg[o].dep.day<10?"0":"")+currentItin.itin[s].seg[o].dep.day+e[currentItin.itin[s].seg[o].cabin],r+="_",o+=l}}if(currentItin.carriers.length<=3){a+="&_ar.mc.narrowSel=1&ar.mc.narrow=airlines";for(var s=0;3>s;s++)a+=s<currentItin.carriers.length?"&ar.mc.carriers["+s+"]="+currentItin.carriers[s]:"&ar.mc.carriers["+s+"]="}else a+="&_ar.mc.narrowSel=0&ar.mc.narrow=airlines&ar.mc.carriers[0]=&ar.mc.carriers[1]=&ar.mc.carriers[2]=";return a+="&ar.mc.cabin=C",a+="&selectKey="+r.substring(0,r.length-1)},r=i("www.orbitz.com","MM/dd/yy"),a=i("www.cheaptickets.com","MM/dd/yy"),s=i("www.ebookers.com","dd/MM/yy"),o=' <span class="pt-hover-container">[+]<span class="pt-hover-menu">';o+=t.map(function(e,t){return'<a href="'+i(e.host,e.dateFormat)+'" target="_blank">'+e.name+"</a>"}).join("<br/>"),o+="</span></span>",1==mptUsersettings.enableInlinemode?(printUrlInline(a,"Cheaptickets",""),printUrlInline(s,"Ebookers","",null,o),printUrlInline(r,"Orbitz","")):(printUrl(a,"Cheaptickets",""),printUrl(s,"Ebookers","",o),printUrl(r,"Orbitz",""))}function printPriceline(){var e="https://www.priceline.com/airlines/landingServlet?userAction=search",t="&TripType=MD&ProductID=1";t+="&DepCity="+currentItin.itin[0].orig,t+="&ArrCity="+currentItin.itin[0].dest,t+="&DepartureDate="+(Number(currentItin.itin[0].dep.month)<=9?"0":"")+currentItin.itin[0].dep.month.toString()+"/"+(Number(currentItin.itin[0].dep.day)<=9?"0":"")+currentItin.itin[0].dep.day.toString()+"/"+currentItin.itin[0].dep.year.toString();for(var n=1,i=1,r="<externalSearch>",a=0;a<currentItin.itin.length;a++){t+="&MDCity_"+n.toString()+"="+currentItin.itin[a].orig,t+="&DepDateMD"+n.toString()+"="+(Number(currentItin.itin[a].dep.month)<=9?"0":"")+currentItin.itin[a].dep.month.toString()+"/"+(Number(currentItin.itin[a].dep.day)<=9?"0":"")+currentItin.itin[a].dep.day.toString()+"/"+currentItin.itin[a].dep.year.toString(),n++,t+="&MDCity_"+n.toString()+"="+currentItin.itin[a].dest,t+="&DepDateMD"+n.toString()+"="+(Number(currentItin.itin[a].arr.month)<=9?"0":"")+currentItin.itin[a].arr.month.toString()+"/"+(Number(currentItin.itin[a].arr.day)<=9?"0":"")+currentItin.itin[a].arr.day.toString()+"/"+currentItin.itin[a].arr.year.toString(),n++,r+="<slice>";for(var s=0;s<currentItin.itin[a].seg.length;s++){r+="<segment>";for(var o=0;s+o<currentItin.itin[a].seg.length-1&&!(currentItin.itin[a].seg[s+o].fnr!=currentItin.itin[a].seg[s+o+1].fnr||currentItin.itin[a].seg[s+o].layoverduration>=1440);)o++;r+="<number>"+i.toString()+"</number>",r+="<departDateTime>"+(Number(currentItin.itin[a].seg[s].dep.month)<=9?"0":"")+currentItin.itin[a].seg[s].dep.month.toString()+"/"+(Number(currentItin.itin[a].seg[s].dep.day)<=9?"0":"")+currentItin.itin[a].seg[s].dep.day.toString()+"/"+currentItin.itin[a].seg[s].dep.year.toString()+" "+currentItin.itin[a].seg[s].dep.time+":00</departDateTime>",r+="<arrivalDateTime>"+(Number(currentItin.itin[a].seg[s+o].arr.month)<=9?"0":"")+currentItin.itin[a].seg[s+o].arr.month.toString()+"/"+(Number(currentItin.itin[a].seg[s+o].arr.day)<=9?"0":"")+currentItin.itin[a].seg[s+o].arr.day.toString()+"/"+currentItin.itin[a].seg[s+o].arr.year.toString()+" "+currentItin.itin[a].seg[s+o].arr.time+":00</arrivalDateTime>",r+="<origAirportCode>"+currentItin.itin[a].seg[s].orig+"</origAirportCode>",r+="<destAirportCode>"+currentItin.itin[a].seg[s+o].dest+"</destAirportCode>",r+="<carrierCode>"+currentItin.itin[a].seg[s].carrier+"</carrierCode>",r+="<flightNumber>"+currentItin.itin[a].seg[s].fnr+"</flightNumber>",r+="<equipmentCode></equipmentCode>",r+="<bookingClass>"+currentItin.itin[a].seg[s].bookingclass+"</bookingClass>",i++,s+=o,r+="</segment>"}r+="</slice>"}r+="<numberOfTickets>"+currentItin.numPax+"</numberOfTickets><cost><totalFare>0.00</totalFare><baseFare>0.00</baseFare><tax>0.00</tax><fee>0.00</fee></cost>",r+="</externalSearch>",t+="&NumTickets="+currentItin.numPax+"&AirAffiliateSearch=",1==mptUsersettings.enableInlinemode?printUrlInline(e+t+encodeURIComponent(r),"Priceline",""):printUrl(e+t+encodeURIComponent(r),"Priceline","")}function printEtraveli(){if(!(currentItin.itin.length>2)&&(2!=currentItin.itin.length||currentItin.itin[0].orig==currentItin.itin[1].dest&&currentItin.itin[0].dest==currentItin.itin[1].orig)){var e=[{name:"Seat24.se",host:"www.seat24.se"},{name:"Seat24.de",host:"www.seat24.de"},{name:"Seat24.dk",host:"www.seat24.dk"},{name:"Seat24.fi",host:"www.seat24.fi"},{name:"Seat24.no",host:"www.seat24.no"},{name:"Flygvaruhuset.se",host:"www.flygvaruhuset.se"},{name:"Travelpartner.se",host:"www.travelpartner.se"},{name:"Travelpartner.fi",host:"www.travelpartner.fi"},{name:"Travelpartner.no",host:"www.travelpartner.no"},{name:"Budjet.se",host:"www.budjet.se"},{name:"Budjet.fi",host:"www.budjet.fi"},{name:"Budjet.no",host:"www.budjet.no"},{name:"Budjet.dk",host:"www.budjet.dk"},{name:"Goleif.dk",host:"www.goleif.dk"},{name:"Travelfinder.se",host:"www.travelfinder.se"},{name:"Gotogate.no",host:"www.gotogate.no"},{name:"Gotogate.at",host:"www.gotogate.at"},{name:"Gotogate.be",host:"be.gotogate.com"},{name:"Gotogate.bg",host:"bg.gotogate.com"},{name:"Gotogate.ch",host:"www.gotogate.ch"},{name:"Gotogate.cz",host:"cz.gotogate.com"},{name:"Gotogate.es",host:"www.gotogate.es"},{name:"Gotogate.fr",host:"www.gotogate.fr"},{name:"Gotogate.gr",host:"www.gotogate.gr"},{name:"Gotogate.hu",host:"hu.gotogate.com"},{name:"Gotogate.ie",host:"ie.gotogate.com"},{name:"Gotogate.it",host:"www.gotogate.it"},{name:"Gotogate.pl",host:"www.gotogate.pl"},{name:"Gotogate.pt",host:"www.gotogate.pt"},{name:"Gotogate.ro",host:"ro.gotogate.com"},{name:"Gotogate.sk",host:"www.gotogate.sk"},{name:"Gotogate.tr",host:"tr.gotogate.com"},{name:"Gotogate.com.ua",host:"www.gotogate.com.ua"},{name:"Gotogate.co.uk",host:"www.gotogate.co.uk"},{name:"Flybillet.dk",host:"www.flybillet.dk"},{name:"Travelstart.se",host:"www.travelstart.se"},{name:"Travelstart.de",host:"www.travelstart.de"},{name:"Travelstart.dk",host:"www.travelstart.dk"},{name:"Travelstart.fi",host:"www.travelstart.fi"},{name:"Travelstart.no",host:"www.travelstart.no"},{name:"Supersaver.se",host:"www.supersavertravel.se"},{name:"Supersaver.dk",host:"www.supersaver.dk"},{name:"Supersaver.fi",host:"www.supersaver.fi"},{name:"Supersaver.nl",host:"www.supersaver.nl"},{name:"Supersaver.no",host:"www.supersaver.no"},{name:"Supersaver.ru",host:"www.supersaver.ru"}],t=function(e,t){return("0"+e.day).slice(-2)+monthnumberToName(e.month)+(t?e.year.toString().slice(-2):"")},n=function(e){var n="http://"+e+"/air/";return n+=currentItin.itin[0].orig+currentItin.itin[0].dest+t(currentItin.itin[0].dep,!1),currentItin.itin.length>1&&(n+=t(currentItin.itin[1].dep,!1)),n+="/"+currentItin.numPax,n+="?selectionKey="+currentItin.itin.map(function(e){return e.seg.map(function(e){return e.carrier+e.fnr+"-"+t(e.dep,!0)+"-"+e.bookingclass}).join("_")}).join("_")},i=n("www.seat24.de"),r=' <span class="pt-hover-container">[+]<span class="pt-hover-menu">';r+=e.map(function(e,t){return'<a href="'+n(e.host)+'" target="_blank">'+e.name+"</a>"}).join("<br/>"),r+="</span></span>",1==mptUsersettings.enableInlinemode?printUrlInline(i,"Seat24.de","",null,r):printUrl(i,"Seat24.de","",r)}}function printFarefreaks(e){var t=new Array,n=3,i=0,r="https://www.farefreaks.com/landing/landing.php?";r+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"lang=de":"lang=en",r+="&target=flightsearch&referrer=matrix";for(var a=0;a<currentItin.itin.length;a++){1!=e&&(r+="&orig["+i+"]="+currentItin.itin[a].orig,r+="&dest["+i+"]="+currentItin.itin[a].dest,r+="&date["+i+"]="+currentItin.itin[a].dep.year.toString()+"-"+currentItin.itin[a].dep.month+"-"+currentItin.itin[a].dep.day+"_"+currentItin.itin[a].dep.time+":00",r+="&validtime["+i+"]=1",i++);for(var s=0;s<currentItin.itin[a].seg.length;s++){if(1==e){for(var o=0;s+o<currentItin.itin[a].seg.length-1&&!(currentItin.itin[a].seg[s+o].fnr!=currentItin.itin[a].seg[s+o+1].fnr||currentItin.itin[a].seg[s+o].layoverduration>=1440);)o++;r+="&orig["+i+"]="+currentItin.itin[a].seg[s].orig,r+="&dest["+i+"]="+currentItin.itin[a].seg[s+o].dest,r+="&date["+i+"]="+currentItin.itin[a].seg[s].dep.year.toString()+"-"+currentItin.itin[a].seg[s].dep.month+"-"+currentItin.itin[a].seg[s].dep.day+"_"+currentItin.itin[a].seg[s].dep.time+":00",r+="&validtime["+i+"]=1",i++,s+=o}currentItin.itin[a].seg[s].cabin<n&&(n=currentItin.itin[a].seg[s].cabin),inArray(currentItin.itin[a].seg[s].carrier,t)||t.push(currentItin.itin[a].seg[s].carrier)}}if(r+="&adult="+currentItin.numPax,r+="&cabin="+n,r+="&child=0&childage[]=&flexible=0",1==e)r+="&nonstop=1","de"==mptUsersettings.language?desc="Benutze "+i+" Segment(e)":desc="Based on "+i+" segment(s)";else{if(1==i)return!1;r+="&nonstop=0","de"==mptUsersettings.language?desc="Benutze "+i+" Abschnitt(e)":desc="Based on "+i+" segment(s)"}t.length<=3&&(r+="&carrier="+t.toString()),1==mptUsersettings.enableInlinemode&&6>=i?printUrlInline(r,"Farefreaks",desc):6>=i&&printUrl(r,"Farefreaks",desc)}function printGCM(){for(var e="",t=0;t<currentItin.itin.length;t++)for(var n=0;n<currentItin.itin[t].seg.length;n++)e+=currentItin.itin[t].seg[n].orig+"-",n+1<currentItin.itin[t].seg.length?currentItin.itin[t].seg[n].dest!=currentItin.itin[t].seg[n+1].orig&&(e+=currentItin.itin[t].seg[n].dest+";"):e+=currentItin.itin[t].seg[n].dest+";";1==mptUsersettings.enableInlinemode?printImageInline("http://www.gcmap.com/map?MR=900&MX=182x182&PM=*&P="+e,"http://www.gcmap.com/mapui?P="+e):printUrl("http://www.gcmap.com/mapui?P="+e,"GCM","")}function bindSeatguru(){for(var e=0;e<currentItin.itin.length;e++)for(var t=0;t<currentItin.itin[e].seg.length;t++){for(var n=0;t+n<currentItin.itin[e].seg.length-1&&!(currentItin.itin[e].seg[t+n].fnr!=currentItin.itin[e].seg[t+n+1].fnr||currentItin.itin[e].seg[t+n].layoverduration>=1440);)n++;var i=findItinTarget(e+1,t+1,"plane");if(i===!1)return printNotification("Error: Could not find target in bindSeatguru"),!1;var r="http://www.seatguru.com/findseatmap/findseatmap.php?carrier="+currentItin.itin[e].seg[t].carrier+"&flightno="+currentItin.itin[e].seg[t].fnr+"&date="+("0"+currentItin.itin[e].seg[t].dep.month).slice(-2)+"%2F"+("0"+currentItin.itin[e].seg[t].dep.day).slice(-2)+"%2F"+currentItin.itin[e].seg[t].dep.year+"&from_loc="+currentItin.itin[e].seg[t].orig;i.children[0].innerHTML='<a href="'+r+'" target="_blank" style="text-decoration:none;color:black">'+i.children[0].innerHTML+"</a>",t+=n}}function bindPlanefinder(){for(var e=0;e<currentItin.itin.length;e++)for(var t=0;t<currentItin.itin[e].seg.length;t++){for(var n=0;t+n<currentItin.itin[e].seg.length-1&&!(currentItin.itin[e].seg[t+n].fnr!=currentItin.itin[e].seg[t+n+1].fnr||currentItin.itin[e].seg[t+n].layoverduration>=1440);)n++;var i=findItinTarget(e+1,t+1,"flight");if(i===!1)return printNotification("Error: Could not find target in bindPlanefinder"),!1;var r="http://www.planefinder.net/data/flight/"+currentItin.itin[e].seg[t].carrier+currentItin.itin[e].seg[t].fnr;i.children[0].innerHTML='<a href="'+r+'" target="_blank" style="text-decoration:none;color:black">'+i.children[0].innerHTML+"</a>",t+=n}}function openWheretocredit(e){var t=document.getElementById("wheretocredit-container");t.style.display="inline";for(var n={ticketingCarrier:1==currentItin.carriers.length?currentItin.carriers[0]:null,baseFareUSD:currentItin.basefares+currentItin.surcharges,segments:[]},i=0;i<currentItin.itin.length;i++)for(var r=0;r<currentItin.itin[i].seg.length;r++)n.segments.push({origin:currentItin.itin[i].seg[r].orig,destination:currentItin.itin[i].seg[r].dest,departure:new Date(currentItin.itin[i].seg[r].dep.year,currentItin.itin[i].seg[r].dep.month,currentItin.itin[i].seg[r].dep.day),carrier:currentItin.itin[i].seg[r].carrier,bookingClass:currentItin.itin[i].seg[r].bookingclass,codeshare:currentItin.itin[i].seg[r].codeshare,flightNumber:currentItin.itin[i].seg[r].fnr});var a=new XMLHttpRequest;a.open("POST","//www.wheretocredit.com/api/beta/calculate"),a.setRequestHeader("Accept","application/json;charset=UTF-8"),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onreadystatechange=function(){if(4===a.readyState){e.href="//www.wheretocredit.com",e.target="_blank",e.innerHTML="Data provided by wheretocredit.com";var n,i,r;try{n=JSON.parse(a.responseText)}catch(s){n=a.responseText}if(200===a.status&&n&&n.success&&n.value&&n.value.length&&n.value[0].success){n.value[0].value.totals.sort(function(e,t){return e.value===t.value?+(e.name>t.name)||+(e.name===t.name)-1:t.value-e.value}),i=document.createElement("div"),r=n.value[0].value.totals.map(function(e,t){return parseInt(e.value).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" "+e.name+" miles"});for(var o=0;o<r.length;o++)i.appendChild(document.createTextNode(r[o])),i.appendChild(document.createElement("br"));i.removeChild(i.lastChild)}else i=n.errorMessage||n||"API quota exceeded :-/",i=document.createTextNode(i);t.style.display="block",t.innerHTML="",t.appendChild(i)}},a.send(JSON.stringify([n]))}function printWheretocredit(){var e,t='<span id="wheretocredit-container" style="display: none;">&nbsp;<img src="data:image/gif;base64,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" style="width: 1em; height: 1em;"></span>';1==mptUsersettings.enableInlinemode?(printUrlInline("javascript: void(0);","wheretocredit.com","",1,t),e=getSidebarContainer(1)):(printUrl("javascript: void(0);","wheretocredit.com","",t),e=document.getElementById("powertoolslinkcontainer"));var n=e.getElementsByTagName("a"),i=n[n.length-1];i.target="_self",i.innerHTML="Calculate miles with wheretocredit.com",i.onclick=function(){i.onclick=null,openWheretocredit(i)}}function bindWheretocredit(){for(var e=0;e<currentItin.itin.length;e++)for(var t=0;t<currentItin.itin[e].seg.length;t++){var n=findItinTarget(e+1,t+1,"cabin");if(n===!1)return printNotification("Error: Could not find target in bindWheretocredit"),!1;var i="http://www.wheretocredit.com/"+currentItin.itin[e].seg[t].carrier.toLowerCase()+"/"+currentItin.itin[e].seg[t].bookingclass.toLowerCase();n.children[0].innerHTML=n.children[0].innerHTML.replace(/<a.*?\/a>/,"("+currentItin.itin[e].seg[t].bookingclass+")").replace("("+currentItin.itin[e].seg[t].bookingclass+")",'<a href="'+i+'" target="_blank" style="text-decoration:none;color:black">('+currentItin.itin[e].seg[t].bookingclass+")</a>")}}function printUrlInline(e,t,n,i,r){var a='<a href="'+e+'" target="_blank">',s=!1;void 0!==translations[mptUsersettings.language]&&void 0!==translations[mptUsersettings.language].openwith&&(a+=translations[mptUsersettings.language].openwith,s=!0),a+=s===!1?"Open with":"",a+=" "+t+"</a>"+(r||""),printItemInline(a,n,i)}function printItemInline(e,t,n){div=getSidebarContainer(n),div.innerHTML=div.innerHTML+'<li class="powertoolsitem">'+e+(t?"<br/><small>("+t+")</small>":"")+"</li>"}function printImageInline(e,t,n){if(div=getSidebarContainer(n).parentNode,1==mptUsersettings.enableIMGautoload)div.innerHTML=div.innerHTML+(t?'<a href="'+t+'" target="_blank" class="powertoolsitem">':"")+'<img src="'+e+'" style="margin-top:10px;"'+(t?"":' class="powertoolsitem"')+"/>"+(t?"</a>":"");else{var i=Math.random();div.innerHTML=div.innerHTML+'<div id="'+i+'" class="powertoolsitem" style="width:184px;height:100px;background-color:white;cursor:pointer;text-align:center;margin-top:10px;padding-top:84px;"><span>Click</span></div>',document.getElementById(i).onclick=function(){var n=document.createElement("div");n.setAttribute("class","powertoolsitem"),n.innerHTML=(t?'<a href="'+t+'" target="_blank">':"")+'<img src="'+e+'" style="margin-top:10px;"'+(t?"":' class="powertoolsitem"')+"/>"+(t?"</a>":""),document.getElementById(i).parentNode.replaceChild(n,document.getElementById(i))}}}function getSidebarContainer(e){var t=!e||e>=4?document.getElementById("powertoolslinkinlinecontainer"):findtarget(classSettings.resultpage.mcHeader,e).nextElementSibling;return t||createUrlContainerInline()}function createUrlContainerInline(){var e=document.createElement("div");return e.setAttribute("class",classSettings.resultpage.mcDiv),e.innerHTML='<div class="'+classSettings.resultpage.mcHeader+'">Powertools</div><ul id="powertoolslinkinlinecontainer" class="'+classSettings.resultpage.mcLinkList+'"></ul>',
findtarget(classSettings.resultpage.mcDiv,1).parentNode.appendChild(e),document.getElementById("powertoolslinkinlinecontainer")}function printUrl(e,t,n,i){void 0==document.getElementById("powertoolslinkcontainer")&&createUrlContainer();var r='<br><font size=3><bold><a href="'+e+'" target=_blank>',a=!1;void 0!==translations[mptUsersettings.language]&&void 0!==translations[mptUsersettings.language].openwith&&(r+=translations[mptUsersettings.language].openwith,a=!0),r+=a===!1?"Open with":"",r+=" "+t+"</a></font></bold>"+(i||"")+(n?"<br>("+n+")<br>":"<br>");var s=document.getElementById("powertoolslinkcontainer");s.innerHTML=s.innerHTML+r}function createUrlContainer(){var e=document.createElement("div");e.setAttribute("id","powertoolslinkcontainer"),e.setAttribute("style","margin-left:10px;"),findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode.appendChild(e)}function printSeperator(){var e=document.getElementById("powertoolslinkcontainer")||getSidebarContainer();e&&(e.innerHTML=e.innerHTML+(mptUsersettings.enableInlinemode?'<hr class="powertoolsitem"/>':"<br/><hr/>"))}function injectCss(){var e="",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e+=".pt-hover-menu { position:absolute; padding: 8px; background-color: #FFF; border: 1px solid #808080; display:none; }",e+=".pt-hover-container:hover .pt-hover-menu { display:inline; }",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}var mptUsersettings=new Object;mptUsersettings.timeformat="12h",mptUsersettings.language="en",mptUsersettings.enableDeviders=1,mptUsersettings.enableInlinemode=0,mptUsersettings.enableIMGautoload=0,mptUsersettings.enableFarerules=1,mptUsersettings.enablePricebreakdown=1,mptUsersettings.enableMilesbreakdown=1,mptUsersettings.enableMilesbreakdownautoload=0,mptUsersettings.enableMilesInlinemode=0,mptUsersettings.enablePlanefinder=1,mptUsersettings.enableSeatguru=1,mptUsersettings.enableWheretocredit=1,mptUsersettings.acEdition="us",mptUsersettings.aaEdition="en_DE";var mptSettings=new Object;if(mptSettings.itaLanguage="en",mptSettings.retrycount=1,mptSettings.laststatus="",mptSettings.scriptrunning=1,"undefined"==typeof GM_info)mptSettings.scriptEngine=0;else{mptSettings.scriptEngine=1;var mptSavedUsersettings=GM_getValue("mptUsersettings","");mptSavedUsersettings&&(mptSavedUsersettings=JSON.parse(mptSavedUsersettings),mptUsersettings.timeformat=void 0===mptSavedUsersettings.timeformat?mptUsersettings.timeformat:mptSavedUsersettings.timeformat,mptUsersettings.language=void 0===mptSavedUsersettings.language?mptUsersettings.language:mptSavedUsersettings.language,mptUsersettings.enableDeviders=void 0===mptSavedUsersettings.enableDeviders?mptUsersettings.enableDeviders:mptSavedUsersettings.enableDeviders,mptUsersettings.enableInlinemode=void 0===mptSavedUsersettings.enableInlinemode?mptUsersettings.enableInlinemode:mptSavedUsersettings.enableInlinemode,mptUsersettings.enableIMGautoload=void 0===mptSavedUsersettings.enableIMGautoload?mptUsersettings.enableIMGautoload:mptSavedUsersettings.enableIMGautoload,mptUsersettings.enableFarerules=void 0===mptSavedUsersettings.enableFarerules?mptUsersettings.enableFarerules:mptSavedUsersettings.enableFarerules,mptUsersettings.enablePricebreakdown=void 0===mptSavedUsersettings.enablePricebreakdown?mptUsersettings.enablePricebreakdown:mptSavedUsersettings.enablePricebreakdown,mptUsersettings.enableMilesbreakdown=void 0===mptSavedUsersettings.enableMilesbreakdown?mptUsersettings.enableMilesbreakdown:mptSavedUsersettings.enableMilesbreakdown,mptUsersettings.enableMilesbreakdownautoload=void 0===mptSavedUsersettings.enableMilesbreakdownautoload?mptUsersettings.enableMilesbreakdownautoload:mptSavedUsersettings.enableMilesbreakdownautoload,mptUsersettings.enableMilesInlinemode=void 0===mptSavedUsersettings.enableMilesInlinemode?mptUsersettings.enableMilesInlinemode:mptSavedUsersettings.enableMilesInlinemode,mptUsersettings.enablePlanefinder=void 0===mptSavedUsersettings.enablePlanefinder?mptUsersettings.enablePlanefinder:mptSavedUsersettings.enablePlanefinder,mptUsersettings.enableSeatguru=void 0===mptSavedUsersettings.enableSeatguru?mptUsersettings.enableSeatguru:mptSavedUsersettings.enableSeatguru,mptUsersettings.enableWheretocredit=void 0===mptSavedUsersettings.enableWheretocredit?mptUsersettings.enableWheretocredit:mptSavedUsersettings.enableWheretocredit,mptUsersettings.acEdition=void 0===mptSavedUsersettings.acEdition?mptUsersettings.acEdition:mptSavedUsersettings.acEdition,mptUsersettings.aaEdition=void 0===mptSavedUsersettings.aaEdition?mptUsersettings.aaEdition:mptSavedUsersettings.aaEdition)}var acEditions=["us","ca","ar","au","ch","cl","cn","co","de","dk","es","fr","gb","hk","ie","il","it","jp","mx","nl","no","pa","pe","se"],aaEditions=[{value:"en_AU",name:"Australia"},{value:"en_BE",name:"Belgium"},{value:"en_CN",name:"China"},{value:"en_DK",name:"Denmark"},{value:"en_FI",name:"Finland"},{value:"en_FR",name:"France / English"},{value:"fr_FR",name:"France / French"},{value:"en_DE",name:"Germany / English"},{value:"de_DE",name:"Germany / Deutsch"},{value:"en_GR",name:"Greece"},{value:"en_HK",name:"Hong Kong"},{value:"en_IN",name:"India"},{value:"en_IE",name:"Ireland"},{value:"en_IL",name:"Israel"},{value:"en_IT",name:"Italy"},{value:"en_JP",name:"Japan"},{value:"en_KR",name:"Korea"},{value:"en_NL",name:"Netherlands"},{value:"en_NZ",name:"New Zealand"},{value:"en_NO",name:"Norway"},{value:"en_PT",name:"Portugal"},{value:"en_RU",name:"Russia"},{value:"en_ES",name:"Spain"},{value:"en_SE",name:"Sweden"},{value:"en_CH",name:"Switzerland"}],classSettings=new Object;classSettings.startpage=new Object,classSettings.startpage.maindiv="IR6M2QD-w-d",classSettings.resultpage=new Object,classSettings.resultpage.itin="IR6M2QD-A-d",classSettings.resultpage.itinRow="IR6M2QD-k-i",classSettings.resultpage.milagecontainer="IR6M2QD-A-e",classSettings.resultpage.rulescontainer="IR6M2QD-l-d",classSettings.resultpage.htbContainer="IR6M2QD-F-k",classSettings.resultpage.htbLeft="IR6M2QD-l-g",classSettings.resultpage.htbRight="IR6M2QD-l-f",classSettings.resultpage.htbGreyBorder="IR6M2QD-l-l",classSettings.resultpage.mcDiv="IR6M2QD-U-e",classSettings.resultpage.mcHeader="IR6M2QD-U-b",classSettings.resultpage.mcLinkList="IR6M2QD-U-c";var translations=new Object;translations.de=new Object,translations.de.openwith="&Ouml;ffne mit",translations.de.resultpage=new Object,translations.de.resultpage["Dep:"]="Abflug:",translations.de.resultpage["Arr:"]="Ankunft:",translations.de.resultpage["Layover in"]="Umst. in",translations.de.resultpage[" to "]=" nach ",translations.de.resultpage["Mon,"]="Mo.,",translations.de.resultpage["Tue,"]="Di.,",translations.de.resultpage["Wed,"]="Mi.,",translations.de.resultpage["Thu,"]="Do.,",translations.de.resultpage["Fri,"]="Fr.,",translations.de.resultpage["Sat,"]="Sa.,",translations.de.resultpage["Sun,"]="So.,",translations.de.resultpage[" Jan "]=" Januar ",translations.de.resultpage[" Feb "]=" Februar ",translations.de.resultpage[" Mar "]=" M&auml;rz ",translations.de.resultpage[" Apr "]=" April ",translations.de.resultpage[" May "]=" Mai ",translations.de.resultpage[" Jun "]=" Juni ",translations.de.resultpage[" Jul "]=" Juli ",translations.de.resultpage[" Aug "]=" August ",translations.de.resultpage[" Sep "]=" September ",translations.de.resultpage[" Oct "]=" Oktober ",translations.de.resultpage[" Nov "]=" November ",translations.de.resultpage[" Dez "]=" Dezember ",translations.de.resultpage["OPERATED BY "]="Durchgef&uuml;hrt von ";var distances=new Object,currentItin=new Object;0===mptSettings.scriptEngine&&window.top===window.self?startScript():window.top===window.self&&("undefined"!=typeof window.addEventListener?window.addEventListener("load",startScript(),!1):"undefined"!=typeof window.attachEvent?window.attachEvent("onload",startScript()):window.onload=startScript());
