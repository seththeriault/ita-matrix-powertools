function startScript(){null===document.getElementById("mptSettingsContainer")&&createUsersettings(),window.location.href!==mptSettings.laststatus&&(setTimeout(function(){getPageLang()},100),mptSettings.laststatus=window.location.href),1===mptSettings.scriptrunning&&setTimeout(function(){startScript()},500)}function createUsersettings(){var t="",e=document.createElement("div");e.setAttribute("id","mptSettingsContainer"),e.setAttribute("style","border-bottom: 1px dashed grey;"),e.innerHTML='<div><div style="display:inline-block;float:left;">Powertools running</div><div id="mtpNotification" style="margin-left:50px;display:inline-block;"></div><div id="settingsvistoggler" style="display:inline-block;float:right;cursor:pointer;">Show/Hide Settings</div><div id="mptSettings" class="invis" style="display:none;border-top: 1px dotted grey;"><div>';var n=document.getElementById("contentwrapper");n.parentNode.insertBefore(e,n),document.getElementById("settingsvistoggler").onclick=function(){toggleSettingsvis()},n=document.getElementById("mptSettings"),t='<div style="float:left;width:25%">',t+='<div id="mpttimeformat" style="cursor:pointer;">Timeformat:<label>'+printSettingsvalue("timeformat")+"</label></div>",t+='<div id="mptlanguage" style="cursor:pointer;">Language:<label>'+printSettingsvalue("language")+"</label></div>",t+='<div id="mptenableDeviders" style="cursor:pointer;">Enable deviders:<label>'+printSettingsvalue("enableDeviders")+"</label></div>",t+='<div id="mptenableInlinemode" style="cursor:pointer;">Inlinemode:<label>'+printSettingsvalue("enableInlinemode")+"</label></div>",t+='<div id="mptenableFarerules" style="cursor:pointer;">Open fare-rules in new window:<label>'+printSettingsvalue("enableFarerules")+"</label></div>",t+='</div><div style="float:left;width:25%">',t+='<div id="mptenablePricebreakdown" style="cursor:pointer;">Price breakdown:<label>'+printSettingsvalue("enablePricebreakdown")+"</label></div>",t+='<div id="mptenableMilesbreakdown" style="cursor:pointer;">Miles breakdown:<label>'+printSettingsvalue("enableMilesbreakdown")+"</label></div>",t+='<div id="mptenableMilesbreakdownautoload" style="cursor:pointer;">Miles breakdown autoload:<label>'+printSettingsvalue("enableMilesbreakdownautoload")+"</label></div>",t+='<div id="mptenableMilesInlinemode" style="cursor:pointer;">Print miles breakdown inline:<label>'+printSettingsvalue("enableMilesInlinemode")+"</label></div>",t+='<div id="mptenableIMGautoload" style="cursor:pointer;">Images autoload:<label>'+printSettingsvalue("enableIMGautoload")+"</label></div>",t+='</div><div style="float:left;width:25%">',t+='<div id="mptenablePlanefinder" style="cursor:pointer;">Enable Planefinder:<label>'+printSettingsvalue("enablePlanefinder")+"</label></div>",t+='<div id="mptenableSeatguru" style="cursor:pointer;">Enable Seatguru:<label>'+printSettingsvalue("enableSeatguru")+"</label></div>",t+='<div id="mptenableWheretocredit" style="cursor:pointer;">Enable WhereToCredit:<label>'+printSettingsvalue("enableWheretocredit")+"</label></div>",t+='</div><div style="float:left;width:25%">',t+='<div id="mptacEdition" style="cursor:pointer;">Air Canada Edition:<label>'+printSettingsvalue("acEdition")+"</label></div>",t+='</div><div style="clear:both;"></div>',n.innerHTML=t,document.getElementById("mpttimeformat").onclick=function(){toggleSettings("timeformat")},document.getElementById("mptlanguage").onclick=function(){toggleSettings("language")},document.getElementById("mptenableDeviders").onclick=function(){toggleSettings("enableDeviders")},document.getElementById("mptenableInlinemode").onclick=function(){toggleSettings("enableInlinemode")},document.getElementById("mptenableIMGautoload").onclick=function(){toggleSettings("enableIMGautoload")},document.getElementById("mptenableFarerules").onclick=function(){toggleSettings("enableFarerules")},document.getElementById("mptenablePricebreakdown").onclick=function(){toggleSettings("enablePricebreakdown")},document.getElementById("mptenableMilesbreakdown").onclick=function(){toggleSettings("enableMilesbreakdown")},document.getElementById("mptenableMilesbreakdownautoload").onclick=function(){toggleSettings("enableMilesbreakdownautoload")},document.getElementById("mptenableMilesInlinemode").onclick=function(){toggleSettings("enableMilesInlinemode")},document.getElementById("mptenablePlanefinder").onclick=function(){toggleSettings("enablePlanefinder")},document.getElementById("mptenableSeatguru").onclick=function(){toggleSettings("enableSeatguru")},document.getElementById("mptenableWheretocredit").onclick=function(){toggleSettings("enableWheretocredit")},document.getElementById("mptacEdition").onclick=function(){toggleSettings("acEdition")}}function toggleSettingsvis(){var t=document.getElementById("mptSettings");hasClass(t,"vis")?(t.setAttribute("class","invis"),t.style.display="none"):(t.setAttribute("class","vis"),t.style.display="block")}function toggleSettings(t){switch(t){case"timeformat":mptUsersettings.timeformat="12h"==mptUsersettings.timeformat?"24h":"12h";break;case"language":mptUsersettings.language="de"==mptUsersettings.language?"en":"de";break;case"acEdition":mptUsersettings.acEdition=acEditions.indexOf(mptUsersettings.acEdition)==acEditions.length-1?acEditions[0]:acEditions[acEditions.indexOf(mptUsersettings.acEdition)+1];break;default:mptUsersettings[t]=1==mptUsersettings[t]?0:1}document.getElementById("mpt"+t).firstChild.nextSibling.innerHTML=printSettingsvalue(t),1===mptSettings.scriptEngine&&GM_setValue("mptUsersettings",JSON.stringify(mptUsersettings))}function printSettingsvalue(t){var e="";switch(t){case"timeformat":e=mptUsersettings.timeformat;break;case"language":e=mptUsersettings.language;break;case"acEdition":e=mptUsersettings.acEdition;break;default:e=boolToEnabled(mptUsersettings[t])}return e}function printNotification(t){var e=document.getElementById("mtpNotification");null===e?alert("mtp Error: Notification container not Found"):e.innerHTML="empty"==t?"":e.innerHTML+"<div>"+t+"</div>"}function getPageLang(){printNotification("empty"),mptSettings.itaLanguage="en",mptSettings.retrycount=1,-1!=window.location.href.indexOf("view-details")?setTimeout(function(){fePS()},200):(-1!=window.location.href.indexOf("#search:")||"https://matrix.itasoftware.com/"==window.location.href||"https://matrix.itasoftware.com/"==window.location.href)&&setTimeout(function(){startPage()},200)}function exRE(t,e){for(var n,i=new Array,r=0;null!=(n=e.exec(t));)for(n.index===e.lastIndex&&e.lastIndex++,k=1;k<n.length;k++)i[r++]=n[k];return i}function inArray(t,e){for(var n=e.length,i=0;n>i;i++)if(e[i]==t)return!0;return!1}function monthnameToNumber(t){var e=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return e.indexOf(t.toUpperCase())+1}function monthnumberToName(t){var e=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return e[t-1]}function getFlightYear(t,e){var n=new Date,i=n.getMonth(),r=n.getDate(),a=n.getFullYear();return(i>e-1||i==e-1&&r>t)&&(a+=1),a}function return12htime(t){var e=/([01]?\d)(:\d{2})(AM|PM|am|pm| AM| PM| am| pm)/g;t=e.exec(t);var n=0;return t[3]=trimStr(t[3]),"AM"!=t[3]&&"am"!=t[3]||"12"!=t[1]?"PM"!=t[3]&&"pm"!=t[3]||"12"==t[1]||(n=12):n=-12,+t[1]+n+t[2]}function trimStr(t){return t.replace(/^\s+|\s+$/gm,"")}function boolToEnabled(t){return 1==t?"enabled":"disabled"}function getcabincode(t){switch(t){case"E":t=0;break;case"P":t=1;break;case"B":t=2;break;case"F":t=3;break;default:t=0}return t}function findtarget(t,e){var n,i=document.getElementsByTagName("*");j=0;for(n in i)if((" "+i[n].className+" ").indexOf(" "+t+" ")>-1&&(j++,j==e))return i[n]}function findtargets(t){var e,n=document.getElementsByTagName("*"),i=new Array;for(e in n)(" "+n[e].className+" ").indexOf(" "+t+" ")>-1&&i.push(n[e]);return i}function hasClass(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")>-1}function doHttpRequest(t,e){if("function"!=typeof e)return printNotification("Error: Invalid callback in doHttpRequest -> not a function"),!1;var n=!1;return"undefined"!=typeof XMLHttpRequest&&(n=new XMLHttpRequest),n?(n.onreadystatechange=function(){if(4==n.readyState&&200==n.status)e(n);else if(4==n.readyState&&200!=n.status)return printNotification("Error: Failed to complete http request"),!1},n.open("GET",t,!0),void n.send()):(printNotification("Error: Failed to initialize http request"),!1)}function findItinTarget(t,e,n){var r=findtarget(classSettings.resultpage.itin,1);if(r===!1)return printNotification("Error: Itin not found in findItinTarget-function"),!1;r=r.nextSibling.nextSibling;var r=r.children[t-1];if(void 0===r)return printNotification("Error: Leg not found in findItinTarget-function"),!1;if(r=r.children[1].children,r.length>=2){var a=0,s=0;for(i=0;i<r.length;i++)if(1==hasClass(r[i],classSettings.resultpage.itinRow)&&(s++,s>=e)){a=i,(2===r.length||3===r.length)&&a--;break}if(i==r.length)return printNotification("Error: Call to unreachable Segment in Leg "+t+" in findItinTarget-function"),!1;var o=0,l=0;switch(n){case"headline":o=-1*a,l=1;break;case"logo":o=0,l=0;break;case"airportsdate":o=0,l=1;break;case"flight":o=1,l=0;break;case"deptime":o=1,l=1;break;case"arrtime":o=1,l=2;break;case"duration":o=1,l=2;break;case"plane":o=1,l=4;break;case"cabin":o=1,l=5;break;default:return printNotification("Error: Unknown Target in findItinTarget-function"),!1}return r[a+o].children[l]}return printNotification("Error: Unknown error in findItinTarget-function"),!1}function startPage(){return void 0===findtarget(classSettings.startpage.maindiv,1)?(printNotification("Error: Unable to find content on start page."),!1):(target=findtarget(classSettings.startpage.maindiv,1),void target.children[0].children[0].children[0].children[0].setAttribute("valign","top"))}function fePS(){if(void 0===findtarget(classSettings.resultpage.itin,1))return printNotification("Error: Unable to find Content on result page."),!1;if("none"!=findtarget(classSettings.resultpage.itin,1).parentNode.previousSibling.previousSibling.style.display)return mptSettings.retrycount++,mptSettings.retrycount>50?(printNotification("Error: Timeout on result page. Content not found after 10s."),!1):(setTimeout(function(){fePS()},200),!1);for(n in classSettings.resultpage)if(void 0===findtarget(classSettings.resultpage[n],1))return printNotification("Error: Unable to find class "+classSettings.resultpage[n]+" for "+n+"."),!1;if(1==mptUsersettings.enableFarerules&&bindRulelinks(),void 0!=document.getElementById("powertoolslinkcontainer")){var t=document.getElementById("powertoolslinkcontainer");t.innerHTML=""}for(var e=findtargets("powertoolsitem"),n=e.length-1;n>=0;n--)e[n].parentNode.removeChild(e[n]);1==mptUsersettings.enableInlinemode?findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",10):0==mptUsersettings.enableInlinemode&&1==mptUsersettings.enablePricebreakdown?findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",3):findtarget(classSettings.resultpage.milagecontainer,1).setAttribute("rowspan",2),readItinerary(),"en"!==mptUsersettings.language&&void 0!==translations[mptUsersettings.language].resultpage&&translate("resultpage",mptUsersettings.language,findtarget(classSettings.resultpage.itin,1).nextSibling.nextSibling);var i=findtarget("pricebreakdown",1);void 0!=i&&i.parentNode.removeChild(i),1==mptUsersettings.enablePricebreakdown&&rearrangeprices(currentItin.dist),1==mptUsersettings.enableInlinemode&&printCPM(),printAC(),2==currentItin.itin.length&&currentItin.itin[0].orig==currentItin.itin[1].dest&&currentItin.itin[0].dest==currentItin.itin[1].orig&&printAF(),1==currentItin.carriers.length&&"AZ"==currentItin.carriers[0]&&printAZ(),printDelta(),printKL(),printUA(),1==currentItin.carriers.length&&"US"==currentItin.carriers[0]&&printUS(),1==mptUsersettings.enableDeviders&&printSeperator(),printCheapOair(),printOrbitz(),printHipmunk(),printPriceline(),1==mptUsersettings.enableDeviders&&printSeperator(),printFarefreaks(0),printFarefreaks(1),printGCM(),1==mptUsersettings.enableSeatguru&&bindSeatguru(),1==mptUsersettings.enablePlanefinder&&bindPlanefinder(),1==mptUsersettings.enableMilesbreakdown&&"undefined"!=typeof JSON&&printMilesbreakdown(),1==mptUsersettings.enableWheretocredit&&bindWheretocredit()}function bindRulelinks(){var t=0,e=0,n=1,i=findtarget(classSettings.resultpage.rulescontainer,n);if(void 0!=i)do{var r=Number(i.firstChild.innerHTML.replace(/[^\d]/gi,""));t>r&&(e++,t=0),i=i.nextSibling.nextSibling.nextSibling;var a=window.location.href.replace(/view-details/,"view-rules")+";fare-key="+e+"/"+t,s=document.createElement("a");s.setAttribute("class","gwt-Anchor"),s.setAttribute("href",a),s.setAttribute("target","_blank");var o=document.createTextNode("rules");s.appendChild(o),i.parentNode.replaceChild(s,i),t++,n++,i=findtarget(classSettings.resultpage.rulescontainer,n)}while(void 0!=i)}function rearrangeprices(){var t=0,e=0,n=0,i=0,r="",a=new RegExp("((YQ|YR))"),s=1,o=findtarget(classSettings.resultpage.htbLeft,s);if(0==mptUsersettings.enableInlinemode)var l="",d=0;if(void 0!=o)do{var g=o.firstChild.firstChild.nodeType;if(1==g){i=1;var c=Number(o.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));""==r&&(r=o.nextSibling.firstChild.innerHTML.replace(/[\d,.]/g,"")),t+=c}else if(1==i&&3==g){var u=o.firstChild.innerHTML,c=Number(o.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));if(1==hasClass(o.nextSibling,classSettings.resultpage.htbGreyBorder)){var p=t+e+n;if(1==mptUsersettings.enableInlinemode){var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Basefare per passenger ('+(t/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbGreyBorder+'"><div class="gwt-Label">'+r+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Taxes per passenger ('+(e/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbRight+'"><div class="gwt-Label">'+r+(e/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Surcharges per passenger ('+(n/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbRight+'"><div class="gwt-Label">'+r+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode);var m=document.createElement("tr");m.innerHTML='<td class="'+classSettings.resultpage.htbLeft+'"><div class="gwt-Label">Basefare + Taxes per passenger ('+((t+e)/p*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.resultpage.htbGreyBorder+'"><div class="gwt-Label">'+r+((t+e)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",o.parentNode.parentNode.insertBefore(m,o.parentNode)}else d++,l+='<table style="float:left; margin-right:15px;"><tbody>',l+='<tr><td colspan=3 style="text-align:center;">Price breakdown '+d+":</td></tr>",l+="<tr><td>"+r+' per mile</td><td colspan=2 style="text-align:center;">'+(p/currentItin.dist/100).toFixed(4).toString()+"</td></tr>",l+='<tr><td>Basefare</td><td style="padding:0px 3px;text-align:right;">'+(t/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td>Tax</td><td style="padding:0px 3px;text-align:right;">'+(e/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(e/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td>Surcharges</td><td style="padding:0px 3px;text-align:right;">'+(n/p*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+r+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+='<tr><td style="border-top: 1px solid #878787;padding:2px 0">Bf+Tax</td><td style="border-top: 1px solid #878787;padding:2px 3px;text-align:right;">'+((t+e)/p*100).toFixed(1).toString()+'%</td><td style="border-top: 1px solid #878787;padding:2px 0; text-align:right;">'+r+((t+e)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",l+="</tbody></table>";i=0,t=0,e=0,n=0}else a.test(u)===!0?n+=c:e+=c}s++,o=findtarget(classSettings.resultpage.htbLeft,s)}while(void 0!=o);if(0==mptUsersettings.enableInlinemode){var f=findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode,m=document.createElement("tr");m.setAttribute("class","pricebreakdown"),m.innerHTML="<td><div>"+l+"</div></td>",f.parentNode.insertBefore(m,f)}}function printMilesbreakdown(){1==mptUsersettings.enableMilesbreakdownautoload?retrieveMileages():(target=findItinTarget(1,1,"headline"),target.innerHTML=target.innerHTML.replace(target.firstChild.className,target.firstChild.className+'" style="display:inline-block')+'<div id="loadmileage" class="'+target.firstChild.className+'" style="display:inline-block;cursor:pointer;float:right;">Load mileage</div>',document.getElementById("loadmileage").onclick=function(){document.getElementById("loadmileage").parentNode.removeChild(document.getElementById("loadmileage")),retrieveMileages()})}function retrieveMileages(){for(var t=new Object,e="",n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)void 0===distances[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]&&void 0===distances[currentItin.itin[n].seg[i].dest+currentItin.itin[n].seg[i].orig]&&void 0===t[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]&&void 0===t[currentItin.itin[n].seg[i].dest+currentItin.itin[n].seg[i].orig]&&(t[currentItin.itin[n].seg[i].orig+currentItin.itin[n].seg[i].dest]=currentItin.itin[n].seg[i].orig+"-"+currentItin.itin[n].seg[i].dest);for(n in t)e+=(""===e?"":"&")+"r[]="+t[n];return""===e?(printMileages(),!1):void doHttpRequest("https://www.farefreaks.com/ajax/calcroutedist.php?"+e,function(t){var e=!1;if("undefined"==typeof JSON)return printNotification("Error: Failed parsing route data - Browser not supporting JSON"),!1;try{e=JSON.parse(t.responseText)}catch(i){e=!1}if("object"!=typeof e)return printNotification("Error: Failed parsing route data"),!1;if(void 0===e.success||void 0===e.error||void 0===e.data)return printNotification("Error: wrong route data format"),!1;if("1"!==e.success)return printNotification("Error: "+e.error+" in retrieveMileages function"),!1;for(n in e.data)distances[n]=parseFloat(e.data[n]);printMileages()})}function printMileages(){for(var t=0,e=0;e<currentItin.itin.length;e++){for(var n=0;n<currentItin.itin[e].seg.length;n++){if(void 0===distances[currentItin.itin[e].seg[n].orig+currentItin.itin[e].seg[n].dest]&&void 0===distances[currentItin.itin[e].seg[n].dest+currentItin.itin[e].seg[n].orig])return printNotification("Error: Missing route data for "+currentItin.itin[e].seg[n].orig+" => "+currentItin.itin[e].seg[n].dest),!1;currentItin.itin[e].seg[n].dist=void 0!==distances[currentItin.itin[e].seg[n].orig+currentItin.itin[e].seg[n].dest]&&void 0===distances[currentItin.itin[e].seg[n].dest+currentItin.itin[e].seg[n].orig]?distances[currentItin.itin[e].seg[n].orig+currentItin.itin[e].seg[n].dest]:distances[currentItin.itin[e].seg[n].dest+currentItin.itin[e].seg[n].orig],t+=currentItin.itin[e].seg[n].dist,currentItin.itin[e].seg[n].dist=Math.floor(currentItin.itin[e].seg[n].dist)}currentItin.itin[e].dist=Math.floor(t),t=0}if(1===mptUsersettings.enableInlinemode||1===mptUsersettings.enableMilesInlinemode)for(var i="",e=0;e<currentItin.itin.length;e++){i=findItinTarget(e+1,1,"headline"),i.innerHTML=i.innerHTML.replace(i.firstChild.className,i.firstChild.className+'" style="display:inline-block')+'<div style="display:inline-block;float:right;"> '+currentItin.itin[e].dist+" miles</div>";for(var n=0;n<currentItin.itin[e].seg.length;n++)currentItin.itin[e].seg.length>1&&(i=findItinTarget(e+1,n+1,"airportsdate"),i.innerHTML=i.innerHTML.replace(i.firstChild.className,i.firstChild.className+'" style="display:inline-block')+'<div style="display:inline-block;float:right;margin-right:110px;"> '+currentItin.itin[e].seg[n].dist+" miles</div>")}else{var r="";r+="<tbody>",r+='<tr><td colspan="4" style="text-align:center;">Mileage breakdown:</td></tr>';for(var e=0;e<currentItin.itin.length;e++){r+='<tr><td style="border-bottom: 1px solid #878787;padding:2px 2px">Leg '+(e+1)+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0">'+currentItin.itin[e].orig+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0">'+currentItin.itin[e].dest+'</td><td style="border-bottom: 1px solid #878787;padding:2px 0;text-align:right;">'+currentItin.itin[e].dist+"</td></tr>";for(var n=0;n<currentItin.itin[e].seg.length;n++)currentItin.itin[e].seg.length>1&&(r+="<tr><td></td><td>"+currentItin.itin[e].seg[n].orig+"</td><td>"+currentItin.itin[e].seg[n].dest+'</td><td style="text-align:right;">'+currentItin.itin[e].seg[n].dist+"</td></tr>")}if(r+="</tbody>",void 0===findtarget("pricebreakdown",1)){var a=findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode,s=document.createElement("tr");s.setAttribute("class","pricebreakdown"),s.innerHTML='<td><div><table style="float:left; margin-right:15px;">'+r+"</table></div></td>",a.parentNode.insertBefore(s,a)}else{var a=findtarget("pricebreakdown",1).firstChild.firstChild.firstChild,o=document.createElement("table");o.setAttribute("style","float:left; margin-right:15px;"),o.innerHTML=r,a.parentNode.insertBefore(o,a)}}}function parseAddInfo(t){var e={codeshare:0,layoverduration:0,airportchange:0,arrDate:""};-1==t.indexOf("This flight contains airport changes")&&(airportchange=1),-1==t.indexOf("OPERATED BY")&&(codeshare=1);var n=new Array,i=/\,\s*([a-zA-Z]{3})\s*([0-9]{1,2})/g;n=exRE(t,i),2==n.length&&(e.arrDate={},e.arrDate.month=monthnameToNumber(n[0]),e.arrDate.day=parseInt(n[1]),e.arrDate.year=getFlightYear(e.arrDate.day,e.arrDate.month));var n=new Array,i=/([0-9]{1,2})h\s([0-9]{1,2})m/g;return n=exRE(t,i),2==n.length&&(e.layoverduration=60*parseInt(n[0])+parseInt(n[1])),e}function readItinerary(){var t=new Array,e=new Array,n=new Array,i=new Array,r=document.getElementById("contentwrapper").innerHTML,a=/colspan\=\"5\"[^\(]+\(([\w]{3})[^\(]+\(([\w]{3})/g;for(legs=exRE(r,a),g=0;g<legs.length;g+=2){var s={};s.arr={},s.dep={},s.orig=legs[g],s.dest=legs[g+1],s.seg=new Array,n.push(s)}var o=new Array,a=/Carrier\s[\w]{2}\s([\w]+).*?Covers\s([\w\(\)\s\-,]+)/g;o=exRE(r,a);var l={fares:new Array,legs:new Array};for(g=0;g<o.length;g+=2)l.fares.push(o[g]),l.legs.push(exRE(o[g+1],/(\w\w\w\-\w\w\w)/g));for(var d=new Array,g=0;g<l.legs.length;g++)for(var c=0;c<l.legs[g].length;c++)d.push(l.legs[g][c]+"-"+l.fares[g]);var u=new Array,a=/35px\/(\w{2}).png[^\(]+\(([A-Z]{3})[^\(]+\(([A-Z]{3})[^\,]*\,\s*([a-zA-Z]{3})\s*([0-9]{1,2}).*?gwt-Label.*?([0-9]*)\<.*?Dep:[^0-9]+(.*?)\<.*?Arr:[^0-9]+(.*?)\<.*?([0-9]{1,2})h\s([0-9]{1,2})m.*?gwt-Label.*?\<.*?gwt-Label\"\>(\w).*?\((\w)\).*?\<.*?tr(.*?)(table|airline_logos)/g;u=exRE(r,a);var p=0,m=0;for(g=0;g<u.length;g+=14){temp={},temp.carrier=u[g],temp.orig=u[g+1],temp.dest=u[g+2],temp.dep={},temp.arr={},temp.dep.month=monthnameToNumber(u[g+3]),temp.dep.day=parseInt(u[g+4]),temp.dep.year=getFlightYear(temp.dep.day,temp.dep.month),temp.fnr=u[g+5],"24h"==mptUsersettings.timeformat&&(t.push(u[g+6]),t.push(u[g+7])),u[g+6]=return12htime(u[g+6]),u[g+7]=return12htime(u[g+7]),"24h"==mptUsersettings.timeformat&&(e.push((4==u[g+6].length?"0":"")+u[g+6]),e.push((4==u[g+7].length?"0":"")+u[g+7])),temp.dep.time=u[g+6],temp.arr.time=u[g+7],temp.duration=60*parseInt(u[g+8])+parseInt(u[g+9]),temp.cabin=getcabincode(u[g+10]),temp.bookingclass=u[g+11];var f=parseAddInfo(u[g+12]);""!=f.arrDate?(temp.arr.day=f.arrDate.day,temp.arr.month=f.arrDate.month,temp.arr.year=f.arrDate.year):(temp.arr.day=temp.dep.day,temp.arr.month=temp.dep.month,temp.arr.year=temp.dep.year),temp.codeshare=f.codeshare,temp.layoverduration=f.layoverduration,temp.airportchange=f.airportchange;for(var c=0;c<d.length;c++)-1!=d[c].indexOf(temp.orig+"-"+temp.dest+"-")&&(temp.farebase=d[c].replace(temp.orig+"-"+temp.dest+"-",""),d[c]=temp.farebase,c=d.length);void 0===n[p]&&(n[p]=new Object),void 0===n[p].seg&&(n[p].seg=new Array),n[p].seg.push(temp),inArray(temp.carrier,i)||i.push(temp.carrier),0==m&&(void 0===n[p].dep&&(n[p].dep=new Object),n[p].dep.day=temp.dep.day,n[p].dep.month=temp.dep.month,n[p].dep.year=temp.dep.year,n[p].dep.time=temp.dep.time),void 0===n[p].arr&&(n[p].arr=new Object),n[p].arr.day=temp.arr.day,n[p].arr.month=temp.arr.month,n[p].arr.year=temp.arr.year,n[p].arr.time=temp.arr.time,m++,"table"==u[g+13]&&(p++,m=0)}var b=new Array,a=/Mileage.*?([0-9,]+)\stotal\smiles.*?Total\scost\sfor\s([0-9])\spassenger.*?<div.*?([0-9,.]+)/g;b=exRE(r,a),itinCur="";var a=/Total\scost\sfor\s[0-9]\spassenger([^0-9]+[^\<]+)/g,I=new Array;I=exRE(r,a),I=I[0].replace(/<[^>]+>/g,"");var h=/\â‚¬/;h.test(I)===!0&&(itinCur="EUR");var h=/US\$/;if(h.test(I)===!0&&(itinCur="USD"),currentItin={itin:n,price:b[2].replace(/\,/g,""),numPax:b[1],carriers:i,cur:itinCur,farebases:l.fares,dist:b[0].replace(/\./g,"").replace(/\,/g,"")},t.length>0)for(target=findtarget(classSettings.resultpage.itin,1).nextSibling.nextSibling,g=0;g<t.length;g++)a=new RegExp(t[g],"g"),target.innerHTML=target.innerHTML.replace(a,e[g])}function translate(t,e,n){if(void 0===translations[e])return printNotification("Error: Translation "+e+" not found"),!1;if(void 0===translations[e][t])return printNotification("Error: Translation "+e+" not found for page "+t),!1;for(i in translations[e][t])re=new RegExp(i,"g"),n.innerHTML=n.innerHTML.replace(re,translations[e][t][i])}function printCPM(){printItemInline((Number(currentItin.price)/Number(currentItin.dist)).toFixed(4)+" cpm","",1)}function printAC(){var t="http://www.aircanada.com/aco/flights.do?AH_IATA_NUMBER=0005118&AVAIL_EMMBEDDED_TRANSACTION=FlexPricerAvailabilityServlet";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"&country=DE&countryOfResidence=DE&language=de&LANGUAGE=DE":"&country="+mptUsersettings.acEdition.toUpperCase()+"&countryofResidence="+mptUsersettings.acEdition.toUpperCase()+"&language=en&LANGUAGE=US",t+="&CREATION_MODE=30&EMBEDDED_TRANSACTION=FareServelet&FareRequest=YES&fromThirdParty=YES&HAS_INFANT_1=False&IS_PRIMARY_TRAVELLER_1=True&SITE=SAADSAAD&thirdPartyID=0005118&TRAVELER_TYPE_1=ADT&PRICING_MODE=0",t+="&numberOfChildren=0&numberOfInfants=0&numberOfYouth=0&numberOfAdults="+currentItin.numPax,t+="&tripType="+(currentItin.itin.length>1?"R":"O");for(var e=0;e<currentItin.itin.length;e++){0==e?t+="&departure1="+("0"+currentItin.itin[e].dep.day).slice(-2)+"/"+("0"+currentItin.itin[e].dep.month).slice(-2)+"/"+currentItin.itin[e].dep.year+"&org1="+currentItin.itin[e].orig+"&dest1="+currentItin.itin[e].dest:1==e&&(t+="&departure2="+("0"+currentItin.itin[e].dep.day).slice(-2)+"/"+("0"+currentItin.itin[e].dep.month).slice(-2)+"/"+currentItin.itin[e].dep.year);for(var n=0;n<currentItin.itin[e].seg.length;n++)t+="&AIRLINE_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].carrier,t+="&B_DATE_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].dep.year+("0"+currentItin.itin[e].seg[n].dep.month).slice(-2)+("0"+currentItin.itin[e].seg[n].dep.day).slice(-2)+("0"+currentItin.itin[e].seg[n].dep.time.replace(":","")).slice(-4),t+="&B_LOCATION_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].orig,t+="&E_DATE_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].arr.year+("0"+currentItin.itin[e].seg[n].arr.month).slice(-2)+("0"+currentItin.itin[e].seg[n].arr.day).slice(-2)+("0"+currentItin.itin[e].seg[n].arr.time.replace(":","")).slice(-4),t+="&E_LOCATION_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].dest,t+="&FLIGHT_NUMBER_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].fnr,t+="&RBD_"+(e+1)+"_"+(n+1)+"="+currentItin.itin[e].seg[n].bookingclass}1==mptUsersettings.enableInlinemode?printUrlInline(t,"Air Canada",""):printUrl(t,"Air Canada","")}function printAF(){var t="https://www.airfrance.com/",e="";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"DE/de":"US/en",t+="/local/process/standardbooking/DisplayUpsellAction.do?cabin=Y&calendarSearch=1&listPaxTypo=ADT&subCabin=MCHER&typeTrip=2",t+="&nbPax="+currentItin.numPax;for(var n=0;n<currentItin.itin.length;n++)if(0==n){t+="&from="+currentItin.itin[n].orig,t+="&to="+currentItin.itin[n].dest,t+="&outboundDate="+currentItin.itin[n].dep.year+"-"+("0"+currentItin.itin[n].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].dep.day).slice(-2),t+="&firstOutboundHour="+("0"+currentItin.itin[n].dep.time).slice(-5),e="";for(var i=0;i<currentItin.itin[n].seg.length;i++)i>0&&(e+="|"),e+=currentItin.itin[n].seg[i].carrier+("000"+currentItin.itin[n].seg[i].fnr).slice(-4);t+="&flightOutbound="+e}else if(1==n){t+="&inboundDate="+currentItin.itin[n].dep.year+"-"+("0"+currentItin.itin[n].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].dep.day).slice(-2),t+="&firstInboundHour="+("0"+currentItin.itin[n].dep.time).slice(-5),e="";for(var i=0;i<currentItin.itin[n].seg.length;i++)i>0&&(e+="|"),e+=currentItin.itin[n].seg[i].carrier+("000"+currentItin.itin[n].seg[i].fnr).slice(-4);t+="&flightInbound="+e}1==mptUsersettings.enableInlinemode?printUrlInline(t,"Air France",""):printUrl(t,"Air France","")}function printAZ(){var t="http://booking.alitalia.com/Booking/"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de":"us_en")+"/Flight/ExtMetaSearch?SearchType=BrandMetasearch";t+="&children_number=0&Children=0&newborn_number=0&Infants=0",t+="&adult_number="+currentItin.numPax+"&Adults="+currentItin.numPax;for(var e=0,n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)t+="&MetaSearchDestinations["+e+"].From="+currentItin.itin[n].seg[i].orig,t+="&MetaSearchDestinations["+e+"].to="+currentItin.itin[n].seg[i].dest,t+="&MetaSearchDestinations["+e+"].DepartureDate="+currentItin.itin[n].seg[i].dep.year+"-"+("0"+currentItin.itin[n].seg[i].dep.month).slice(-2)+"-"+("0"+currentItin.itin[n].seg[i].dep.day).slice(-2),t+="&MetaSearchDestinations["+e+"].Flight="+currentItin.itin[n].seg[i].fnr,t+="&MetaSearchDestinations["+e+"].code="+currentItin.itin[n].seg[i].farebase,t+="&MetaSearchDestinations["+e+"].slices="+n,e++;1==mptUsersettings.enableInlinemode?printUrlInline(t,"Alitalia",""):printUrl(t,"Alitalia","")}function getDeltaCabin(t){switch(t){case 2:t="B2-Business";break;case 3:t="B2-Business";break;default:t="B5-Coach"}return t}function printDelta(){var t="http://"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de":"www");t+=".delta.com/booking/priceItin.do?dispatchMethod=priceItin&tripType=multiCity&cabin=B5-Coach",t+="&currencyCd="+("EUR"==currentItin.cur?"EUR":"USD")+"&exitCountry="+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language,"US");for(var e=0,n=0;n<currentItin.itin.length;n++)for(var i=0;i<currentItin.itin[n].seg.length;i++)t+="&itinSegment["+e.toString()+"]="+n.toString()+":"+currentItin.itin[n].seg[i].bookingclass,t+=":"+currentItin.itin[n].seg[i].orig+":"+currentItin.itin[n].seg[i].dest+":"+currentItin.itin[n].seg[i].carrier+":"+currentItin.itin[n].seg[i].fnr,t+=":"+monthnumberToName(currentItin.itin[n].seg[i].dep.month)+":"+(currentItin.itin[n].seg[i].dep.day<10?"0":"")+currentItin.itin[n].seg[i].dep.day+":"+currentItin.itin[n].seg[i].dep.year+":0",e++;t+="&fareBasis="+currentItin.farebases.toString().replace(/,/g,":"),t+="&price=0",t+="&numOfSegments="+e.toString()+"&paxCount="+currentItin.numPax,t+="&vendorRedirectFlag=true&vendorID=Google",1==mptUsersettings.enableInlinemode?printUrlInline(t,"Delta",""):printUrl(t,"Delta","")}function printKL(){var t="https://www.klm.com/travel/";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de/apps/ebt/ebt_home.htm?lang=DE":"us_en/apps/ebt/ebt_home.htm?lang=EN",t+="&chdQty=0&infQty=0&dev=5&cffcc=ECONOMY";
var e="",n="";t+="&adtQty="+currentItin.numPax;for(var i=0;i<currentItin.itin.length;i++){t+="&c["+i+"].os="+currentItin.itin[i].orig,t+="&c["+i+"].ds="+currentItin.itin[i].dest,t+="&c["+i+"].dd="+currentItin.itin[i].dep.year+"-"+("0"+currentItin.itin[i].dep.month).slice(-2)+"-"+("0"+currentItin.itin[i].dep.day).slice(-2),i>0&&(n+="..");for(var r=0;r<currentItin.itin[i].seg.length;r++)t+="&c["+i+"].s["+r+"].os="+currentItin.itin[i].seg[r].orig,t+="&c["+i+"].s["+r+"].ds="+currentItin.itin[i].seg[r].dest,t+="&c["+i+"].s["+r+"].dd="+currentItin.itin[i].seg[r].dep.year+"-"+("0"+currentItin.itin[i].seg[r].dep.month).slice(-2)+"-"+("0"+currentItin.itin[i].seg[r].dep.day).slice(-2),t+="&c["+i+"].s["+r+"].dt="+("0"+currentItin.itin[i].seg[r].dep.time.replace(":","")).slice(-4),t+="&c["+i+"].s["+r+"].mc="+currentItin.itin[i].seg[r].carrier,t+="&c["+i+"].s["+r+"].fn="+("000"+currentItin.itin[i].seg[r].fnr).slice(-4),r>0&&(n+="."),n+=currentItin.itin[i].seg[r].carrier}for(var i=0;i<currentItin.farebases.length;i++)i>0&&(e+=","),e+=currentItin.farebases[i];t+="&ref=fb="+e,1==mptUsersettings.enableInlinemode?printUrlInline(t,"KLM",""):printUrl(t,"KLM","")}function getUACabin(t){switch(t){case 2:t="Business";break;case 3:t="First";break;default:t="Coach"}return t}function printUA(){var t='{"post": {"pax": '+currentItin.numPax;t+=', "trips": [';for(var e=0;e<currentItin.itin.length;e++){var n=3;t+='{"origin": "'+currentItin.itin[e].orig+'", "dest": "'+currentItin.itin[e].dest+'", "dep_date": "'+currentItin.itin[e].dep.month+"/"+currentItin.itin[e].dep.day+"/"+currentItin.itin[e].dep.year+'", "segments": [';for(var i=0;i<currentItin.itin[e].seg.length;i++){for(var r=0;i+r<currentItin.itin[e].seg.length-1&&!(currentItin.itin[e].seg[i+r].fnr!=currentItin.itin[e].seg[i+r+1].fnr||currentItin.itin[e].seg[i+r].layoverduration>=1440);)r++;t+='{"origin": "'+currentItin.itin[e].seg[i].orig+'", "dep_date": "'+currentItin.itin[e].seg[i].dep.month.toString()+"/"+currentItin.itin[e].seg[i].dep.day.toString()+"/"+currentItin.itin[e].seg[i].dep.year.toString()+'", "dest_date": " ", "dest": "'+currentItin.itin[e].seg[i+r].dest+'", ',t+='"flight_num": '+currentItin.itin[e].seg[i].fnr+', "carrier": "'+currentItin.itin[e].seg[i].carrier+'", "fare_code": "'+currentItin.itin[e].seg[i].farebase+'"},',currentItin.itin[e].seg[i].cabin<n&&(n=currentItin.itin[e].seg[i].cabin),i+=r}t=t.substring(0,t.length-1)+'],"cabin": "'+getUACabin(n)+'"},'}t="https://www.hipmunk.com/bookjs?booking_info="+encodeURIComponent(t.substring(0,t.length-1)+']}, "kind": "flight", "provider_code": "UA" }'),desc="de"==mptUsersettings.language?"Kopiere den Link bei Hipmunk":"Copy Link in Text, via Hipmunk",1==mptUsersettings.enableInlinemode?printUrlInline(t,"United",desc):printUrl(t,"United",desc)}function getUSCabin(t){switch(t){case 2:t="B";break;case 3:t="F";break;default:t="C"}return t}function printUS(){var t="https://shopping.usairways.com/Flights/Passenger.aspx?g=goo&c=goog_US_pax";t+="&a="+currentItin.numPax,t+="&s="+getUSCabin(currentItin.itin[0].seg[0].cabin).toLowerCase();for(var e=0;e<currentItin.itin.length;e++)for(var n=0;n<currentItin.itin[e].seg.length;n++){var i=(e+1).toString()+(n+1).toString();t+="&o"+i+"="+currentItin.itin[e].seg[n].orig+"&d"+i+"="+currentItin.itin[e].seg[n].dest+"&f"+i+"="+currentItin.itin[e].seg[n].fnr,t+="&t"+i+"="+currentItin.itin[e].seg[n].dep.year+(currentItin.itin[e].seg[n].dep.month<10?"0":"")+currentItin.itin[e].seg[n].dep.month+(currentItin.itin[e].seg[n].dep.day<10?"0":"")+currentItin.itin[e].seg[n].dep.day+"0000",t+="&x"+i+"="+currentItin.itin[e].seg[n].farebase}1==mptUsersettings.enableInlinemode?printUrlInline(t,"US Airways",""):printUrl(t,"US Airways","")}function printCheapOair(){var t=["Economy","PREMIUMECONOMY","Business","First"],e="http://www.cheapoair.com/default.aspx?tabid=1832&ch=0&sr=0&is=0&il=0&ulang=en";e+="&ad="+currentItin.numPax;for(var n=0,i={},r=0;r<currentItin.itin.length;r++){i[r]="";for(var a=0;a<currentItin.itin[r].seg.length;a++)n++,i[r]&&(i[r]+=","),i[r]+=n,e+="&cbn"+n+"="+t[currentItin.itin[r].seg[a].cabin],e+="&carr"+n+"="+currentItin.itin[r].seg[a].carrier,e+="&dd"+n+"="+currentItin.itin[r].seg[a].dep.year+("0"+currentItin.itin[r].seg[a].dep.month).slice(-2)+("0"+currentItin.itin[r].seg[a].dep.day).slice(-2),e+="&og"+n+"="+currentItin.itin[r].seg[a].orig,e+="&dt"+n+"="+currentItin.itin[r].seg[a].dest,e+="&fbc"+n+"="+currentItin.itin[r].seg[a].bookingclass,e+="&fnum"+n+"="+currentItin.itin[r].seg[a].fnr;e+="&Slice"+(r+1)+"="+i[r]}e+=1==currentItin.itin.length?"&tt=OneWay":2==currentItin.itin.length&&currentItin.itin[0].orig==currentItin.itin[1].dest&&currentItin.itin[0].dest==currentItin.itin[1].orig?"&tt=RoundTrip":"&tt=MultiCity",1==mptUsersettings.enableInlinemode?printUrlInline(e,"CheapOair",""):printUrl(e,"CheapOair","")}function getHipmunkCabin(t){switch(t){case 2:t="Business";break;case 3:t="First";break;default:t="Coach"}return t}function printHipmunk(){for(var t="https://www.hipmunk.com/search/flights?",e=3,n=0;n<currentItin.itin.length;n++){t+="&from"+n+"="+currentItin.itin[n].orig;for(var i=0;i<currentItin.itin[n].seg.length;i++){for(var r=0;i+r<currentItin.itin[n].seg.length-1&&!(currentItin.itin[n].seg[i+r].fnr!=currentItin.itin[n].seg[i+r+1].fnr||currentItin.itin[n].seg[i+r].layoverduration>=1440);)r++;t+=(i>0?"%20"+currentItin.itin[n].seg[i].orig+"%20":"%3A%3A")+currentItin.itin[n].seg[i].carrier+currentItin.itin[n].seg[i].fnr,currentItin.itin[n].seg[i].cabin<e&&(e=currentItin.itin[n].seg[i].cabin),i+=r}t+="&date"+n+"="+currentItin.itin[n].dep.year+"-"+(Number(currentItin.itin[n].dep.month)<=9?"0":"")+currentItin.itin[n].dep.month.toString()+"-"+(Number(currentItin.itin[n].dep.day)<=9?"0":"")+currentItin.itin[n].dep.day.toString(),t+="&to"+n+"="+currentItin.itin[n].dest}t+="&pax="+currentItin.numPax+"&cabin="+getHipmunkCabin(e)+"&infant_lap=0&infant_seat=0&seniors=0&children=0",1==mptUsersettings.enableInlinemode?printUrlInline(t,"Hipmunk",""):printUrl(t,"Hipmunk","")}function getOrbitzCabin(t){switch(t){case 1:t="E";break;case 2:t="B";break;case 3:t="F";break;default:t="C"}return t}function printOrbitz(){for(var t="",e="/shop/home?type=air&source=GOOGLE_META&searchHost=ITA&ar.type=multiCity&strm=true",n=0;n<currentItin.itin.length;n++){var i=n.toString();e+="&ar.mc.slc["+i+"].orig.key="+currentItin.itin[n].orig,e+="&_ar.mc.slc["+i+"].originRadius=0",e+="&ar.mc.slc["+i+"].dest.key="+currentItin.itin[n].dest,e+="&_ar.mc.slc["+i+"].destinationRadius=0";var r=currentItin.itin[n].dep.year%100;e+="&ar.mc.slc["+i+"].date="+currentItin.itin[n].dep.month.toString()+"/"+currentItin.itin[n].dep.day.toString()+"/"+r.toString(),e+="&ar.mc.slc["+i+"].time=Anytime";for(var a=0;a<currentItin.itin[n].seg.length;a++){for(var s=0;a+s<currentItin.itin[n].seg.length-1&&!(currentItin.itin[n].seg[a+s].fnr!=currentItin.itin[n].seg[a+s+1].fnr||currentItin.itin[n].seg[a+s].layoverduration>=1440);)s++;t+=currentItin.itin[n].seg[a].carrier+currentItin.itin[n].seg[a].fnr+currentItin.itin[n].seg[a].orig+currentItin.itin[n].seg[a+s].dest+(currentItin.itin[n].seg[a].dep.month<10?"0":"")+currentItin.itin[n].seg[a].dep.month+(currentItin.itin[n].seg[a].dep.day<10?"0":"")+currentItin.itin[n].seg[a].dep.day+getOrbitzCabin(currentItin.itin[n].seg[a].cabin),t+="_",a+=s}}if(e+="&ar.mc.numAdult="+currentItin.numPax,e+="&ar.mc.numSenior=0&ar.mc.numChild=0&ar.mc.child[0]=&ar.mc.child[1]=&ar.mc.child[2]=&ar.mc.child[3]=&ar.mc.child[4]=&ar.mc.child[5]=&ar.mc.child[6]=&ar.mc.child[7]=&search=Search Flights&ar.mc.nonStop=true&_ar.mc.nonStop=0",currentItin.carriers.length<=3){e+="&_ar.mc.narrowSel=1&ar.mc.narrow=airlines";for(var n=0;3>n;n++)e+=n<currentItin.carriers.length?"&ar.mc.carriers["+n+"]="+currentItin.carriers[n]:"&ar.mc.carriers["+n+"]="}else e+="&_ar.mc.narrowSel=0&ar.mc.narrow=airlines&ar.mc.carriers[0]=&ar.mc.carriers[1]=&ar.mc.carriers[2]=";if(e+="&ar.mc.cabin=C",e+="&selectKey="+t.substring(0,t.length-1),"USD"==currentItin.cur){var o=parseFloat(currentItin.price)+6.99;e+="&userRate.price=USD|"+o.toString()}1==mptUsersettings.enableInlinemode?(printUrlInline("http://www.cheaptickets.com"+e,"Cheaptickets",""),printUrlInline("http://www.orbitz.com"+e,"Orbitz","")):(printUrl("http://www.cheaptickets.com"+e,"Cheaptickets",""),printUrl("http://www.orbitz.com"+e,"Orbitz",""))}function printPriceline(){var t="https://www.priceline.com/airlines/landingServlet?userAction=search",e="&TripType=MD&ProductID=1";e+="&DepCity="+currentItin.itin[0].orig,e+="&ArrCity="+currentItin.itin[0].dest,e+="&DepartureDate="+(Number(currentItin.itin[0].dep.month)<=9?"0":"")+currentItin.itin[0].dep.month.toString()+"/"+(Number(currentItin.itin[0].dep.day)<=9?"0":"")+currentItin.itin[0].dep.day.toString()+"/"+currentItin.itin[0].dep.year.toString();for(var n=1,i=1,r="<externalSearch>",a=0;a<currentItin.itin.length;a++){e+="&MDCity_"+n.toString()+"="+currentItin.itin[a].orig,e+="&DepDateMD"+n.toString()+"="+(Number(currentItin.itin[a].dep.month)<=9?"0":"")+currentItin.itin[a].dep.month.toString()+"/"+(Number(currentItin.itin[a].dep.day)<=9?"0":"")+currentItin.itin[a].dep.day.toString()+"/"+currentItin.itin[a].dep.year.toString(),n++,e+="&MDCity_"+n.toString()+"="+currentItin.itin[a].dest,e+="&DepDateMD"+n.toString()+"="+(Number(currentItin.itin[a].arr.month)<=9?"0":"")+currentItin.itin[a].arr.month.toString()+"/"+(Number(currentItin.itin[a].arr.day)<=9?"0":"")+currentItin.itin[a].arr.day.toString()+"/"+currentItin.itin[a].arr.year.toString(),n++,r+="<slice>";for(var s=0;s<currentItin.itin[a].seg.length;s++){r+="<segment>";for(var o=0;s+o<currentItin.itin[a].seg.length-1&&!(currentItin.itin[a].seg[s+o].fnr!=currentItin.itin[a].seg[s+o+1].fnr||currentItin.itin[a].seg[s+o].layoverduration>=1440);)o++;r+="<number>"+i.toString()+"</number>",r+="<departDateTime>"+(Number(currentItin.itin[a].seg[s].dep.month)<=9?"0":"")+currentItin.itin[a].seg[s].dep.month.toString()+"/"+(Number(currentItin.itin[a].seg[s].dep.day)<=9?"0":"")+currentItin.itin[a].seg[s].dep.day.toString()+"/"+currentItin.itin[a].seg[s].dep.year.toString()+" "+currentItin.itin[a].seg[s].dep.time+":00</departDateTime>",r+="<arrivalDateTime>"+(Number(currentItin.itin[a].seg[s+o].arr.month)<=9?"0":"")+currentItin.itin[a].seg[s+o].arr.month.toString()+"/"+(Number(currentItin.itin[a].seg[s+o].arr.day)<=9?"0":"")+currentItin.itin[a].seg[s+o].arr.day.toString()+"/"+currentItin.itin[a].seg[s+o].arr.year.toString()+" "+currentItin.itin[a].seg[s+o].arr.time+":00</arrivalDateTime>",r+="<origAirportCode>"+currentItin.itin[a].seg[s].orig+"</origAirportCode>",r+="<destAirportCode>"+currentItin.itin[a].seg[s+o].dest+"</destAirportCode>",r+="<carrierCode>"+currentItin.itin[a].seg[s].carrier+"</carrierCode>",r+="<flightNumber>"+currentItin.itin[a].seg[s].fnr+"</flightNumber>",r+="<equipmentCode></equipmentCode>",r+="<bookingClass>"+currentItin.itin[a].seg[s].bookingclass+"</bookingClass>",i++,s+=o,r+="</segment>"}r+="</slice>"}r+="<numberOfTickets>"+currentItin.numPax+"</numberOfTickets><cost><totalFare>0.00</totalFare><baseFare>0.00</baseFare><tax>0.00</tax><fee>0.00</fee></cost>",r+="</externalSearch>",e+="&NumTickets="+currentItin.numPax+"&AirAffiliateSearch=",1==mptUsersettings.enableInlinemode?printUrlInline(t+e+encodeURIComponent(r),"Priceline",""):printUrl(t+e+encodeURIComponent(r),"Priceline","")}function printFarefreaks(t){var e=new Array,n=3,i=0,r="https://www.farefreaks.com/landing/landing.php?";r+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"lang=de":"lang=en",r+="&target=flightsearch&referrer=matrix";for(var a=0;a<currentItin.itin.length;a++){1!=t&&(r+="&orig["+i+"]="+currentItin.itin[a].orig,r+="&dest["+i+"]="+currentItin.itin[a].dest,r+="&date["+i+"]="+currentItin.itin[a].dep.year.toString()+"-"+currentItin.itin[a].dep.month+"-"+currentItin.itin[a].dep.day+"_"+currentItin.itin[a].dep.time+":00",r+="&validtime["+i+"]=1",i++);for(var s=0;s<currentItin.itin[a].seg.length;s++){if(1==t){for(var o=0;s+o<currentItin.itin[a].seg.length-1&&!(currentItin.itin[a].seg[s+o].fnr!=currentItin.itin[a].seg[s+o+1].fnr||currentItin.itin[a].seg[s+o].layoverduration>=1440);)o++;r+="&orig["+i+"]="+currentItin.itin[a].seg[s].orig,r+="&dest["+i+"]="+currentItin.itin[a].seg[s+o].dest,r+="&date["+i+"]="+currentItin.itin[a].seg[s].dep.year.toString()+"-"+currentItin.itin[a].seg[s].dep.month+"-"+currentItin.itin[a].seg[s].dep.day+"_"+currentItin.itin[a].seg[s].dep.time+":00",r+="&validtime["+i+"]=1",i++,s+=o}currentItin.itin[a].seg[s].cabin<n&&(n=currentItin.itin[a].seg[s].cabin),inArray(currentItin.itin[a].seg[s].carrier,e)||e.push(currentItin.itin[a].seg[s].carrier)}}if(r+="&adult="+currentItin.numPax,r+="&cabin="+n,r+="&child=0&childage[]=&flexible=0",1==t)r+="&nonstop=1",desc="de"==mptUsersettings.language?"Benutze "+i+" Segment(e)":"Based on "+i+" segment(s)";else{if(1==i)return!1;r+="&nonstop=0",desc="de"==mptUsersettings.language?"Benutze "+i+" Abschnitt(e)":"Based on "+i+" segment(s)"}e.length<=3&&(r+="&carrier="+e.toString()),1==mptUsersettings.enableInlinemode&&6>=i?printUrlInline(r,"Farefreaks",desc):6>=i&&printUrl(r,"Farefreaks",desc)}function printGCM(){for(var t="",e=0;e<currentItin.itin.length;e++)for(var n=0;n<currentItin.itin[e].seg.length;n++)t+=currentItin.itin[e].seg[n].orig+"-",n+1<currentItin.itin[e].seg.length?currentItin.itin[e].seg[n].dest!=currentItin.itin[e].seg[n+1].orig&&(t+=currentItin.itin[e].seg[n].dest+";"):t+=currentItin.itin[e].seg[n].dest+";";1==mptUsersettings.enableInlinemode?printImageInline("http://www.gcmap.com/map?MR=900&MX=182x182&PM=*&P="+t,"http://www.gcmap.com/mapui?P="+t):printUrl("http://www.gcmap.com/mapui?P="+t,"GCM","")}function bindSeatguru(){for(var t=0;t<currentItin.itin.length;t++)for(var e=0;e<currentItin.itin[t].seg.length;e++){for(var n=0;e+n<currentItin.itin[t].seg.length-1&&!(currentItin.itin[t].seg[e+n].fnr!=currentItin.itin[t].seg[e+n+1].fnr||currentItin.itin[t].seg[e+n].layoverduration>=1440);)n++;var i=findItinTarget(t+1,e+1,"plane");if(i===!1)return printNotification("Error: Could not find target in bindSeatguru"),!1;var r="http://www.seatguru.com/findseatmap/findseatmap.php?carrier="+currentItin.itin[t].seg[e].carrier+"&flightno="+currentItin.itin[t].seg[e].fnr+"&date="+("0"+currentItin.itin[t].seg[e].dep.month).slice(-2)+"%2F"+("0"+currentItin.itin[t].seg[e].dep.day).slice(-2)+"%2F"+currentItin.itin[t].seg[e].dep.year+"&from_loc="+currentItin.itin[t].seg[e].orig;i.children[0].innerHTML='<a href="'+r+'" target="_blank" style="text-decoration:none;color:black">'+i.children[0].innerHTML+"</a>",e+=n}}function bindPlanefinder(){for(var t=0;t<currentItin.itin.length;t++)for(var e=0;e<currentItin.itin[t].seg.length;e++){for(var n=0;e+n<currentItin.itin[t].seg.length-1&&!(currentItin.itin[t].seg[e+n].fnr!=currentItin.itin[t].seg[e+n+1].fnr||currentItin.itin[t].seg[e+n].layoverduration>=1440);)n++;var i=findItinTarget(t+1,e+1,"flight");if(i===!1)return printNotification("Error: Could not find target in bindPlanefinder"),!1;var r="http://www.planefinder.net/data/flight/"+currentItin.itin[t].seg[e].carrier+currentItin.itin[t].seg[e].fnr;i.children[0].innerHTML='<a href="'+r+'" target="_blank" style="text-decoration:none;color:black">'+i.children[0].innerHTML+"</a>",e+=n}}function bindWheretocredit(){for(var t=0;t<currentItin.itin.length;t++)for(var e=0;e<currentItin.itin[t].seg.length;e++){var n=findItinTarget(t+1,e+1,"cabin");if(n===!1)return printNotification("Error: Could not find target in bindWheretocredit"),!1;var i="http://www.wheretocredit.com/"+currentItin.itin[t].seg[e].carrier+"/"+currentItin.itin[t].seg[e].bookingclass;n.children[0].innerHTML=n.children[0].innerHTML.replace(/<a.*?\/a>/,"("+currentItin.itin[t].seg[e].bookingclass+")").replace("("+currentItin.itin[t].seg[e].bookingclass+")",'<a href="'+i+'" target="_blank" style="text-decoration:none;color:black">('+currentItin.itin[t].seg[e].bookingclass+")</a>")}}function printUrlInline(t,e,n,i){var r='<a href="'+t+'" target="_blank">',a=!1;void 0!==translations[mptUsersettings.language]&&void 0!==translations[mptUsersettings.language].openwith&&(r+=translations[mptUsersettings.language].openwith,a=!0),r+=a===!1?"Open with":"",r+=" "+e+"</a>",printItemInline(r,n,i)}function printItemInline(t,e,n){div=getSidebarContainer(n),div.innerHTML=div.innerHTML+'<li class="powertoolsitem">'+t+(e?"<br/><small>("+e+")</small>":"")+"</li>"}function printImageInline(t,e,n){if(div=getSidebarContainer(n).parentNode,1==mptUsersettings.enableIMGautoload)div.innerHTML=div.innerHTML+(e?'<a href="'+e+'" target="_blank" class="powertoolsitem">':"")+'<img src="'+t+'" style="margin-top:10px;"'+(e?"":' class="powertoolsitem"')+"/>"+(e?"</a>":"");else{var i=Math.random();div.innerHTML=div.innerHTML+'<div id="'+i+'" class="powertoolsitem" style="width:184px;height:100px;background-color:white;cursor:pointer;text-align:center;margin-top:10px;padding-top:84px;"><span>Click</span></div>',document.getElementById(i).onclick=function(){var n=document.createElement("div");n.setAttribute("class","powertoolsitem"),n.innerHTML=(e?'<a href="'+e+'" target="_blank">':"")+'<img src="'+t+'" style="margin-top:10px;"'+(e?"":' class="powertoolsitem"')+"/>"+(e?"</a>":""),document.getElementById(i).parentNode.replaceChild(n,document.getElementById(i))}}}function getSidebarContainer(t){var e=!t||t>=4?document.getElementById("powertoolslinkinlinecontainer"):findtarget(classSettings.resultpage.mcHeader,t).nextElementSibling;return e||createUrlContainerInline()}function createUrlContainerInline(){var t=document.createElement("div");return t.setAttribute("class",classSettings.resultpage.mcDiv),t.innerHTML='<div class="'+classSettings.resultpage.mcHeader+'">Powertools</div><ul id="powertoolslinkinlinecontainer" class="'+classSettings.resultpage.mcLinkList+'"></ul>',findtarget(classSettings.resultpage.mcDiv,1).parentNode.appendChild(t),document.getElementById("powertoolslinkinlinecontainer")}function printUrl(t,e,n){void 0==document.getElementById("powertoolslinkcontainer")&&createUrlContainer();var i='<br><font size=3><bold><a href="'+t+'" target=_blank>',r=!1;void 0!==translations[mptUsersettings.language]&&void 0!==translations[mptUsersettings.language].openwith&&(i+=translations[mptUsersettings.language].openwith,r=!0),i+=r===!1?"Open with":"",i+=" "+e+"</a></font></bold>"+(n?"<br>("+n+")<br>":"<br>");var a=document.getElementById("powertoolslinkcontainer");a.innerHTML=a.innerHTML+i}function createUrlContainer(){var t=document.createElement("div");t.setAttribute("id","powertoolslinkcontainer"),t.setAttribute("style","margin-left:10px;"),findtarget(classSettings.resultpage.htbContainer,1).parentNode.parentNode.parentNode.appendChild(t)}function printSeperator(){var t=document.getElementById("powertoolslinkcontainer")||getSidebarContainer();t&&(t.innerHTML=t.innerHTML+(mptUsersettings.enableInlinemode?'<hr class="powertoolsitem"/>':"<br/><hr/>"))}var mptUsersettings=new Object;mptUsersettings.timeformat="12h",mptUsersettings.language="en",mptUsersettings.enableDeviders=1,mptUsersettings.enableInlinemode=0,mptUsersettings.enableIMGautoload=0,mptUsersettings.enableFarerules=1,mptUsersettings.enablePricebreakdown=1,mptUsersettings.enableMilesbreakdown=1,mptUsersettings.enableMilesbreakdownautoload=0,mptUsersettings.enableMilesInlinemode=0,mptUsersettings.enablePlanefinder=1,mptUsersettings.enableSeatguru=1,mptUsersettings.enableWheretocredit=1,mptUsersettings.acEdition="us";var mptSettings=new Object;if(mptSettings.itaLanguage="en",mptSettings.retrycount=1,mptSettings.laststatus="",mptSettings.scriptrunning=1,"undefined"==typeof GM_info)mptSettings.scriptEngine=0;else{mptSettings.scriptEngine=1;var mptSavedUsersettings=GM_getValue("mptUsersettings","");mptSavedUsersettings&&(mptSavedUsersettings=JSON.parse(mptSavedUsersettings),mptUsersettings.timeformat=void 0===mptSavedUsersettings.timeformat?mptUsersettings.timeformat:mptSavedUsersettings.timeformat,mptUsersettings.language=void 0===mptSavedUsersettings.language?mptUsersettings.language:mptSavedUsersettings.language,mptUsersettings.enableDeviders=void 0===mptSavedUsersettings.enableDeviders?mptUsersettings.enableDeviders:mptSavedUsersettings.enableDeviders,mptUsersettings.enableInlinemode=void 0===mptSavedUsersettings.enableInlinemode?mptUsersettings.enableInlinemode:mptSavedUsersettings.enableInlinemode,mptUsersettings.enableIMGautoload=void 0===mptSavedUsersettings.enableIMGautoload?mptUsersettings.enableIMGautoload:mptSavedUsersettings.enableIMGautoload,mptUsersettings.enableFarerules=void 0===mptSavedUsersettings.enableFarerules?mptUsersettings.enableFarerules:mptSavedUsersettings.enableFarerules,mptUsersettings.enablePricebreakdown=void 0===mptSavedUsersettings.enablePricebreakdown?mptUsersettings.enablePricebreakdown:mptSavedUsersettings.enablePricebreakdown,mptUsersettings.enableMilesbreakdown=void 0===mptSavedUsersettings.enableMilesbreakdown?mptUsersettings.enableMilesbreakdown:mptSavedUsersettings.enableMilesbreakdown,mptUsersettings.enableMilesbreakdownautoload=void 0===mptSavedUsersettings.enableMilesbreakdownautoload?mptUsersettings.enableMilesbreakdownautoload:mptSavedUsersettings.enableMilesbreakdownautoload,mptUsersettings.enableMilesInlinemode=void 0===mptSavedUsersettings.enableMilesInlinemode?mptUsersettings.enableMilesInlinemode:mptSavedUsersettings.enableMilesInlinemode,mptUsersettings.enablePlanefinder=void 0===mptSavedUsersettings.enablePlanefinder?mptUsersettings.enablePlanefinder:mptSavedUsersettings.enablePlanefinder,mptUsersettings.enableSeatguru=void 0===mptSavedUsersettings.enableSeatguru?mptUsersettings.enableSeatguru:mptSavedUsersettings.enableSeatguru,mptUsersettings.enableWheretocredit=void 0===mptSavedUsersettings.enableWheretocredit?mptUsersettings.enableWheretocredit:mptSavedUsersettings.enableWheretocredit,mptUsersettings.acEdition=void 0===mptSavedUsersettings.acEdition?mptUsersettings.acEdition:mptSavedUsersettings.acEdition)}var acEditions=["us","ca","ar","au","ch","cl","cn","co","de","dk","es","fr","gb","hk","ie","il","it","jp","mx","nl","no","pa","pe","se"],classSettings=new Object;classSettings.startpage=new Object,classSettings.startpage.maindiv="IR6M2QD-w-d",classSettings.resultpage=new Object,classSettings.resultpage.itin="IR6M2QD-A-d",classSettings.resultpage.itinRow="IR6M2QD-k-i",classSettings.resultpage.milagecontainer="IR6M2QD-A-e",classSettings.resultpage.rulescontainer="IR6M2QD-l-d",classSettings.resultpage.htbContainer="IR6M2QD-F-k",classSettings.resultpage.htbLeft="IR6M2QD-l-g",classSettings.resultpage.htbRight="IR6M2QD-l-f",classSettings.resultpage.htbGreyBorder="IR6M2QD-l-l",classSettings.resultpage.mcDiv="IR6M2QD-U-e",classSettings.resultpage.mcHeader="IR6M2QD-U-b",classSettings.resultpage.mcLinkList="IR6M2QD-U-c";var translations=new Object;translations.de=new Object,translations.de.openwith="&Ouml;ffne mit",translations.de.resultpage=new Object,translations.de.resultpage["Dep:"]="Abflug:",translations.de.resultpage["Arr:"]="Ankunft:",translations.de.resultpage["Layover in"]="Umst. in",translations.de.resultpage[" to "]=" nach ",translations.de.resultpage["Mon,"]="Mo.,",translations.de.resultpage["Tue,"]="Di.,",translations.de.resultpage["Wed,"]="Mi.,",translations.de.resultpage["Thu,"]="Do.,",translations.de.resultpage["Fri,"]="Fr.,",translations.de.resultpage["Sat,"]="Sa.,",translations.de.resultpage["Sun,"]="So.,",translations.de.resultpage[" Jan "]=" Januar ",translations.de.resultpage[" Feb "]=" Februar ",translations.de.resultpage[" Mar "]=" M&auml;rz ",translations.de.resultpage[" Apr "]=" April ",translations.de.resultpage[" May "]=" Mai ",translations.de.resultpage[" Jun "]=" Juni ",translations.de.resultpage[" Jul "]=" Juli ",translations.de.resultpage[" Aug "]=" August ",translations.de.resultpage[" Sep "]=" September ",translations.de.resultpage[" Oct "]=" Oktober ",translations.de.resultpage[" Nov "]=" November ",translations.de.resultpage[" Dez "]=" Dezember ",translations.de.resultpage["OPERATED BY "]="Durchgef&uuml;hrt von ";var distances=new Object,currentItin=new Object;0===mptSettings.scriptEngine&&window.top===window.self?startScript():window.top===window.self&&("undefined"!=typeof window.addEventListener?window.addEventListener("load",startScript(),!1):"undefined"!=typeof window.attachEvent?window.attachEvent("onload",startScript()):window.onload=startScript());
