function startcript(){window.location.href!=mptSettings.laststatus&&(setTimeout(function(){getPageLang()},100),mptSettings.laststatus=window.location.href),1==mptSettings.scriptrunning&&setTimeout(function(){startcript()},500)}function startcript(){null==document.getElementById("mptSettingsContainer")&&createUsersettings(),window.location.href!=mptSettings.laststatus&&(setTimeout(function(){getPageLang()},100),mptSettings.laststatus=window.location.href),1==mptSettings.scriptrunning&&setTimeout(function(){startcript()},500)}function createUsersettings(){var e=document.createElement("div");e.setAttribute("id","mptSettingsContainer"),e.setAttribute("style","border-bottom: 1px dashed grey;"),e.innerHTML='<div><span>Powertools running</span><span id="settingsvistoggler" style="float:right;cursor:pointer;">Show/Hide Settings</span><div id="mptSettings" class="invis" style="display:none;border-top: 1px dotted grey;"><div>';var t=document.getElementById("contentwrapper");t.parentNode.insertBefore(e,t),document.getElementById("settingsvistoggler").onclick=function(){toggleSettingsvis()},t=document.getElementById("mptSettings"),t.innerHTML='<span id="mpttimeformat" style="cursor:pointer;">Timeformat:<span>'+printSettingsvalue("timeformat")+"</span></span><br>",t.innerHTML+='<span id="mptlanguage" style="cursor:pointer;">Language:<span>'+printSettingsvalue("language")+"</span></span><br>",t.innerHTML+='<span id="mptenableInlinemode" style="cursor:pointer;">Inlinemode:<span>'+printSettingsvalue("enableInlinemode")+"</span></span><br>",t.innerHTML+='<span id="mptenableIMGautoload" style="cursor:pointer;">Images autoload:<span>'+printSettingsvalue("enableIMGautoload")+"</span></span><br>",t.innerHTML+='<span id="mptenableFarerules" style="cursor:pointer;">Farerules in new window:<span>'+printSettingsvalue("enableFarerules")+"</span></span><br>",t.innerHTML+='<span id="mptenablePricebreakdown" style="cursor:pointer;">Price breakdown:<span>'+printSettingsvalue("enablePricebreakdown")+"</span></span><br>",t.innerHTML+='<span id="mptacEdition" style="cursor:pointer;">Air Canada Edition:<span>'+printSettingsvalue("acEdition")+"</span></span>",document.getElementById("mpttimeformat").onclick=function(){toggleSettings("timeformat")},document.getElementById("mptlanguage").onclick=function(){toggleSettings("language")},document.getElementById("mptenableInlinemode").onclick=function(){toggleSettings("enableInlinemode")},document.getElementById("mptenableIMGautoload").onclick=function(){toggleSettings("enableIMGautoload")},document.getElementById("mptenableFarerules").onclick=function(){toggleSettings("enableFarerules")},document.getElementById("mptenablePricebreakdown").onclick=function(){toggleSettings("enablePricebreakdown")},document.getElementById("mptacEdition").onclick=function(){toggleSettings("acEdition")}}function toggleSettingsvis(){var e=document.getElementById("mptSettings");hasClass(e,"vis")?(e.setAttribute("class","invis"),e.style.display="none"):(e.setAttribute("class","vis"),e.style.display="block")}function toggleSettings(e){switch(e){case"timeformat":mptUsersettings.timeformat="12h"==mptUsersettings.timeformat?"24h":"12h";break;case"language":mptUsersettings.language="de"==mptUsersettings.language?"en":"de";break;case"acEdition":mptUsersettings.acEdition=acEditions.indexOf(mptUsersettings.acEdition)==acEditions.length-1?acEditions[0]:acEditions[acEditions.indexOf(mptUsersettings.acEdition)+1];break;default:mptUsersettings[e]=1==mptUsersettings[e]?0:1}document.getElementById("mpt"+e).firstChild.nextSibling.innerHTML=printSettingsvalue(e)}function printSettingsvalue(e){var t="";switch(e){case"timeformat":t=mptUsersettings.timeformat;break;case"language":t=mptUsersettings.language;break;case"acEdition":t=mptUsersettings.acEdition;break;default:t=boolToEnabled(mptUsersettings[e])}return t}function getPageLang(){console.log("Matrix 3.0: Set lang to en"),mptSettings.itaLanguage="en",mptSettings.retrycount=1,-1!=window.location.href.indexOf("view-details")&&setTimeout(function(){fePS()},200)}function exRE(e,t){for(var n,i=new Array,r=0;null!=(n=t.exec(e));)for(n.index===t.lastIndex&&t.lastIndex++,k=1;k<n.length;k++)i[r++]=n[k];return i}function inArray(e,t){for(var n=t.length,i=0;n>i;i++)if(t[i]==e)return!0;return!1}function monthnameToNumber(e){var t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return t.indexOf(e.toUpperCase())+1}function monthnumberToName(e){var t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];return t[e-1]}function getFlightYear(e,t){var n=new Date,i=n.getMonth(),r=n.getDate(),a=n.getFullYear();return(i>t-1||i==t-1&&r>e)&&(a+=1),a}function return12htime(e){var t=/([01]?\d)(:\d{2})(AM|PM|am|pm| AM| PM| am| pm)/g;e=t.exec(e);var n=0;return e[3]=trimStr(e[3]),"AM"!=e[3]&&"am"!=e[3]||"12"!=e[1]?"PM"!=e[3]&&"pm"!=e[3]||"12"==e[1]||(n=12):n=-12,+e[1]+n+e[2]}function trimStr(e){return e.replace(/^\s+|\s+$/gm,"")}function boolToEnabled(e){return 1==e?"enabled":"disabled"}function getcabincode(e){switch(e){case"E":e=0;break;case"P":e=1;break;case"B":e=2;break;case"F":e=3;break;default:e=0}return e}function findtarget(e,t){var n,i=document.getElementsByTagName("*");j=0;for(n in i)if((" "+i[n].className+" ").indexOf(" "+e+" ")>-1&&(j++,j==t))return i[n]}function findtargets(e){var t,n=document.getElementsByTagName("*"),i=new Array;for(t in n)(" "+n[t].className+" ").indexOf(" "+e+" ")>-1&&i.push(n[t]);return i}function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function fePS(){if("none"!=findtarget(classSettings.itin,1).parentNode.previousSibling.previousSibling.style.display)return mptSettings.retrycount++,mptSettings.retrycount>20?(console.log("Error Content not found."),!1):(setTimeout(function(){fePS()},200),!1);if(1==mptUsersettings.enableFarerules&&bindRulelinks(),void 0!=document.getElementById("powertoolslinkcontainer")){var e=document.getElementById("powertoolslinkcontainer");e.innerHTML=""}for(var t=findtargets("powertoolsitem"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n]);1==mptUsersettings.enableInlinemode?findtarget(classSettings.milagecontainer,1).setAttribute("rowspan",10):0==mptUsersettings.enableInlinemode&&1==mptUsersettings.enablePricebreakdown?findtarget(classSettings.milagecontainer,1).setAttribute("rowspan",3):findtarget(classSettings.milagecontainer,1).setAttribute("rowspan",2);var i=readItinerary(),r=findtarget("pricebreakdown",1);void 0!=r&&r.parentNode.removeChild(r),1==mptUsersettings.enablePricebreakdown&&rearrangeprices(i.dist),1==mptUsersettings.enableInlinemode&&printCPM(i),printAC(i),2==i.itin.length&&i.itin[0].orig==i.itin[1].dest&&i.itin[0].dest==i.itin[1].orig&&printAF(i),1==i.carriers.length&&"AZ"==i.carriers[0]&&printAZ(i),printDelta(i),printKL(i),printUA(i),1==i.carriers.length&&"US"==i.carriers[0]&&printUS(i),printOrbitz(i),printHipmunk(i),printPriceline(i),printFarefreaks(i,0),printFarefreaks(i,1),printGCM(i)}function bindRulelinks(){var e=0,t=0,n=1,i=findtarget(classSettings.rulescontainer,n);if(void 0!=i)do{var r=Number(i.firstChild.innerHTML.replace(/[^\d]/gi,""));e>r&&(t++,e=0),i=i.nextSibling.nextSibling.nextSibling;var a=window.location.href.replace(/view-details/,"view-rules")+";fare-key="+t+"/"+e,s=document.createElement("a");s.setAttribute("class","gwt-Anchor"),s.setAttribute("href",a),s.setAttribute("target","_blank");var o=document.createTextNode("rules");s.appendChild(o),i.parentNode.replaceChild(s,i),e++,n++,i=findtarget(classSettings.rulescontainer,n)}while(void 0!=i)}function rearrangeprices(e){var t=0,n=0,i=0,r=0,a="",s=new RegExp("((YQ|YR))"),o=1,g=findtarget(classSettings.htbLeft,o);if(0==mptUsersettings.enableInlinemode)var d="",l=0;if(void 0!=g)do{var p=g.firstChild.firstChild.nodeType;if(1==p){r=1;var c=Number(g.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));""==a&&(a=g.nextSibling.firstChild.innerHTML.replace(/[\d,.]/g,"")),t+=c}else if(1==r&&3==p){var m=g.firstChild.innerHTML,c=Number(g.nextSibling.firstChild.innerHTML.replace(/[^\d]/gi,""));if(1==hasClass(g.nextSibling,classSettings.htbGreyBorder)){var u=t+n+i;if(1==mptUsersettings.enableInlinemode){var h=document.createElement("tr");h.innerHTML='<td class="'+classSettings.htbLeft+'"><div class="gwt-Label">Basefare per passenger ('+(t/u*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.htbGreyBorder+'"><div class="gwt-Label">'+a+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",g.parentNode.parentNode.insertBefore(h,g.parentNode);var h=document.createElement("tr");h.innerHTML='<td class="'+classSettings.htbLeft+'"><div class="gwt-Label">Taxes per passenger ('+(n/u*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.htbRight+'"><div class="gwt-Label">'+a+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",g.parentNode.parentNode.insertBefore(h,g.parentNode);var h=document.createElement("tr");h.innerHTML='<td class="'+classSettings.htbLeft+'"><div class="gwt-Label">Surcharges per passenger ('+(i/u*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.htbRight+'"><div class="gwt-Label">'+a+(i/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",g.parentNode.parentNode.insertBefore(h,g.parentNode);var h=document.createElement("tr");h.innerHTML='<td class="'+classSettings.htbLeft+'"><div class="gwt-Label">Basefare + Taxes per passenger ('+((t+n)/u*100).toFixed(2).toString()+'%)</div></td><td class="'+classSettings.htbGreyBorder+'"><div class="gwt-Label">'+a+((t+n)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</div></td>",g.parentNode.parentNode.insertBefore(h,g.parentNode)}else l++,d+='<table style="float:left; margin-right:15px;"><tbody>',d+='<tr><td colspan=3 style="text-align:center;">Price breakdown '+l+":</td></tr>",d+='<tr><td>CPM</td><td colspan=2 style="text-align:center;">'+a+(u/e/100).toFixed(4).toString()+"</td></tr>",d+='<tr><td>Basefare</td><td style="padding:0px 3px;text-align:right;">'+(t/u*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+a+(t/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",d+='<tr><td>Tax</td><td style="padding:0px 3px;text-align:right;">'+(n/u*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+a+(n/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",d+='<tr><td>Surcharges</td><td style="padding:0px 3px;text-align:right;">'+(i/u*100).toFixed(1).toString()+'%</td><td style="text-align:right;">'+a+(i/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",d+='<tr><td style="border-top: 1px solid #878787;padding:2px 0">Bf+Tax</td><td style="border-top: 1px solid #878787;padding:2px 3px;text-align:right;">'+((t+n)/u*100).toFixed(1).toString()+'%</td><td style="border-top: 1px solid #878787;padding:2px 0; text-align:right;">'+a+((t+n)/100).toFixed(2).toString().replace(/\d(?=(\d{3})+\.)/g,"$&,")+"</td></tr>",d+="</tbody></table>";r=0,t=0,n=0,i=0}else s.test(m)===!0?i+=c:n+=c}o++,g=findtarget(classSettings.htbLeft,o)}while(void 0!=g);if(0==mptUsersettings.enableInlinemode){var f=findtarget(classSettings.htbContainer,1).parentNode.parentNode.parentNode,h=document.createElement("tr");h.setAttribute("class","pricebreakdown"),h.innerHTML="<td><div>"+d+"</div></td>",f.parentNode.insertBefore(h,f)}}function parseAddInfo(e){var t={codeshare:0,layoverduration:0,airportchange:0,arrDate:""};-1==e.indexOf("This flight contains airport changes")&&(airportchange=1),-1==e.indexOf("OPERATED BY")&&(codeshare=1);var n=new Array,i=/\,\s*([a-zA-Z]{3})\s*([0-9]{1,2})/g;n=exRE(e,i),2==n.length&&(t.arrDate={},t.arrDate.month=monthnameToNumber(n[0]),t.arrDate.day=parseInt(n[1]),t.arrDate.year=getFlightYear(t.arrDate.day,t.arrDate.month));var n=new Array,i=/([0-9]{1,2})h\s([0-9]{1,2})m/g;return n=exRE(e,i),2==n.length&&(t.layoverduration=60*parseInt(n[0])+parseInt(n[1])),t}function readItinerary(){var e=new Array,t=new Array;"de"==mptUsersettings.language&&(e.push("Dep:"),t.push("Abflug:"),e.push("Arr:"),t.push("Ankunft:"),e.push("Layover in"),t.push("Umst. in"),e.push(" to "),t.push(" nach "),e.push("Mon,"),t.push("Mo.,"),e.push("Tue,"),t.push("Di.,"),e.push("Wed,"),t.push("Mi.,"),e.push("Thu,"),t.push("Do.,"),e.push("Fri,"),t.push("Fr.,"),e.push("Sat,"),t.push("Sa.,"),e.push("Sun,"),t.push("So.,"),e.push(" Jan "),t.push(" Januar "),e.push(" Feb "),t.push(" Februar "),e.push(" Mar "),t.push(" M&auml;rz "),e.push(" Apr "),t.push(" April "),e.push(" May "),t.push(" Mai "),e.push(" Jun "),t.push(" Juni "),e.push(" Jul "),t.push(" Juli "),e.push(" Aug "),t.push(" August "),e.push(" Sep "),t.push(" September "),e.push(" Oct "),t.push(" Oktober "),e.push(" Nov "),t.push(" November "),e.push(" Dez "),t.push(" Dezember "),e.push("OPERATED BY "),t.push("Durchgef&uuml;hrt von "));var n=new Array,i=new Array,r=document.getElementById("contentwrapper").innerHTML,a=/colspan\=\"5\"[^\(]+\(([\w]{3})[^\(]+\(([\w]{3})/g;for(legs=exRE(r,a),l=0;l<legs.length;l+=2){var s={};s.arr={},s.dep={},s.orig=legs[l],s.dest=legs[l+1],s.seg=new Array,n.push(s)}var o=new Array,a=/Carrier\s[\w]{2}\s([\w]+).*?Covers\s([\w\(\)\s\-,]+)/g;o=exRE(r,a);var g={fares:new Array,legs:new Array};for(l=0;l<o.length;l+=2)g.fares.push(o[l]),g.legs.push(exRE(o[l+1],/(\w\w\w\-\w\w\w)/g));for(var d=new Array,l=0;l<g.legs.length;l++)for(var p=0;p<g.legs[l].length;p++)d.push(g.legs[l][p]+"-"+g.fares[l]);var c=new Array,a=/35px\/(\w{2}).png[^\(]+\(([A-Z]{3})[^\(]+\(([A-Z]{3})[^\,]*\,\s*([a-zA-Z]{3})\s*([0-9]{1,2}).*?gwt-Label.*?([0-9]*)\<.*?Dep:[^0-9]+(.*?)\<.*?Arr:[^0-9]+(.*?)\<.*?([0-9]{1,2})h\s([0-9]{1,2})m.*?gwt-Label.*?\<.*?gwt-Label\"\>(\w).*?\((\w)\).*?\<.*?tr(.*?)(table|airline_logos)/g;c=exRE(r,a);var m=0,u=0;for(l=0;l<c.length;l+=14){temp={},temp.carrier=c[l],temp.orig=c[l+1],temp.dest=c[l+2],temp.dep={},temp.arr={},temp.dep.month=monthnameToNumber(c[l+3]),temp.dep.day=parseInt(c[l+4]),temp.dep.year=getFlightYear(temp.dep.day,temp.dep.month),temp.fnr=c[l+5],"24h"==mptUsersettings.timeformat&&(e.push(c[l+6]),e.push(c[l+7])),c[l+6]=return12htime(c[l+6]),c[l+7]=return12htime(c[l+7]),"24h"==mptUsersettings.timeformat&&(t.push((4==c[l+6].length?"0":"")+c[l+6]),t.push((4==c[l+7].length?"0":"")+c[l+7])),temp.dep.time=c[l+6],temp.arr.time=c[l+7],temp.duration=60*parseInt(c[l+8])+parseInt(c[l+9]),temp.cabin=getcabincode(c[l+10]),temp.bookingclass=c[l+11];var h=parseAddInfo(c[l+12]);""!=h.arrDate?(temp.arr.day=h.arrDate.day,temp.arr.month=h.arrDate.month,temp.arr.year=h.arrDate.year):(temp.arr.day=temp.dep.day,temp.arr.month=temp.dep.month,temp.arr.year=temp.dep.year),temp.codeshare=h.codeshare,temp.layoverduration=h.layoverduration,temp.airportchange=h.airportchange;for(var p=0;p<d.length;p++)-1!=d[p].indexOf(temp.orig+"-"+temp.dest+"-")&&(temp.farebase=d[p].replace(temp.orig+"-"+temp.dest+"-",""),d[p]=temp.farebase,p=d.length);n[m].seg.push(temp),inArray(temp.carrier,i)||i.push(temp.carrier),0==u&&(n[m].dep.day=temp.dep.day,n[m].dep.month=temp.dep.month,n[m].dep.year=temp.dep.year,n[m].dep.time=temp.dep.time),n[m].arr.day=temp.arr.day,n[m].arr.month=temp.arr.month,n[m].arr.year=temp.arr.year,n[m].arr.time=temp.arr.time,u++,"table"==c[l+13]&&(m++,u=0)}var f=new Array,a=/Mileage[^0-9]+([0-9,]+).*?Total\scost\sfor\s([0-9])\spassenger[^0-9]+([0-9,.]+)/g;f=exRE(r,a),itinCur="";var a=/Total\scost\sfor\s[0-9]\spassenger([^0-9]+[^\<]+)/g,b=new Array;b=exRE(r,a),b=b[0].replace(/<[^>]+>/g,"");var S=/\â‚¬/;S.test(b)===!0&&(itinCur="EUR");var S=/US\$/;if(S.test(b)===!0&&(itinCur="USD"),data={itin:n,price:f[2].replace(/\,/g,""),numPax:f[1],carriers:i,cur:itinCur,farebases:g.fares,dist:f[0].replace(/\./g,"").replace(/\,/g,"")},e.length>0)for(target=findtarget(classSettings.itin,1).nextSibling.nextSibling,l=0;l<e.length;l++)a=new RegExp(e[l],"g"),target.innerHTML=target.innerHTML.replace(a,t[l]);return data}function printCPM(e){printItemInline((Number(e.price)/Number(e.dist)).toFixed(4)+" cpm","",1)}function getDeltaCabin(e){switch(e){case 2:e="B2-Business";break;case 3:e="B2-Business";break;default:e="B5-Coach"}return e}function printDelta(e){var t="http://"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de":"www");t+=".delta.com/booking/priceItin.do?dispatchMethod=priceItin&tripType=multiCity&cabin=B5-Coach",t+="&currencyCd="+("EUR"==e.cur?"EUR":"USD")+"&exitCountry="+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language,"US");for(var n=0,i=0;i<e.itin.length;i++)for(var r=0;r<e.itin[i].seg.length;r++)t+="&itinSegment["+n.toString()+"]="+i.toString()+":"+e.itin[i].seg[r].bookingclass,t+=":"+e.itin[i].seg[r].orig+":"+e.itin[i].seg[r].dest+":"+e.itin[i].seg[r].carrier+":"+e.itin[i].seg[r].fnr,t+=":"+monthnumberToName(e.itin[i].seg[r].dep.month)+":"+(e.itin[i].seg[r].dep.day<10?"0":"")+e.itin[i].seg[r].dep.day+":"+e.itin[i].seg[r].dep.year+":0",n++;t+="&fareBasis="+e.farebases.toString().replace(/,/g,":"),t+="&price=0",t+="&numOfSegments="+n.toString()+"&paxCount="+e.numPax,t+="&vendorRedirectFlag=true&vendorID=Google",1==mptUsersettings.enableInlinemode?printUrlInline(t,"Delta",""):printUrl(t,"Delta","")}function printAF(e){var t="https://www.airfrance.com/",n="";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"DE/de":"US/en",t+="/local/process/standardbooking/DisplayUpsellAction.do?cabin=Y&calendarSearch=1&listPaxTypo=ADT&subCabin=MCHER&typeTrip=2",t+="&nbPax="+e.numPax;for(var i=0;i<e.itin.length;i++)if(0==i){t+="&from="+e.itin[i].orig,t+="&to="+e.itin[i].dest,t+="&outboundDate="+e.itin[i].dep.year+"-"+("0"+e.itin[i].dep.month).slice(-2)+"-"+("0"+e.itin[i].dep.day).slice(-2),t+="&firstOutboundHour="+("0"+e.itin[i].dep.time).slice(-5),n="";for(var r=0;r<e.itin[i].seg.length;r++)r>0&&(n+="|"),n+=e.itin[i].seg[r].carrier+("000"+e.itin[i].seg[r].fnr).slice(-4);t+="&flightOutbound="+n}else if(1==i){t+="&inboundDate="+e.itin[i].dep.year+"-"+("0"+e.itin[i].dep.month).slice(-2)+"-"+("0"+e.itin[i].dep.day).slice(-2),t+="&firstInboundHour="+("0"+e.itin[i].dep.time).slice(-5),n="";for(var r=0;r<e.itin[i].seg.length;r++)r>0&&(n+="|"),n+=e.itin[i].seg[r].carrier+("000"+e.itin[i].seg[r].fnr).slice(-4);t+="&flightInbound="+n}1==mptUsersettings.enableInlinemode?printUrlInline(t,"Air France",""):printUrl(t,"Air France","")}function printAZ(e){var t="http://booking.alitalia.com/Booking/"+("de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de":"us_en")+"/Flight/ExtMetaSearch?SearchType=BrandMetasearch";t+="&children_number=0&Children=0&newborn_number=0&Infants=0",t+="&adult_number="+e.numPax+"&Adults="+e.numPax;for(var n=0,i=0;i<e.itin.length;i++)for(var r=0;r<e.itin[i].seg.length;r++)t+="&MetaSearchDestinations["+n+"].From="+e.itin[i].seg[r].orig,t+="&MetaSearchDestinations["+n+"].to="+e.itin[i].seg[r].dest,t+="&MetaSearchDestinations["+n+"].DepartureDate="+e.itin[i].seg[r].dep.year+"-"+("0"+e.itin[i].seg[r].dep.month).slice(-2)+"-"+("0"+e.itin[i].seg[r].dep.day).slice(-2),t+="&MetaSearchDestinations["+n+"].Flight="+e.itin[i].seg[r].fnr,t+="&MetaSearchDestinations["+n+"].code="+e.itin[i].seg[r].farebase,t+="&MetaSearchDestinations["+n+"].slices="+i,n++;1==mptUsersettings.enableInlinemode?printUrlInline(t,"Alitalia",""):printUrl(t,"Alitalia","")}function printKL(e){var t="https://www.klm.com/travel/";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"de_de/apps/ebt/ebt_home.htm?lang=DE":"us_en/apps/ebt/ebt_home.htm?lang=EN",t+="&chdQty=0&infQty=0&dev=5&cffcc=ECONOMY";var n="",i="";t+="&adtQty="+e.numPax;for(var r=0;r<e.itin.length;r++){t+="&c["+r+"].os="+e.itin[r].orig,t+="&c["+r+"].ds="+e.itin[r].dest,t+="&c["+r+"].dd="+e.itin[r].dep.year+"-"+("0"+e.itin[r].dep.month).slice(-2)+"-"+("0"+e.itin[r].dep.day).slice(-2),r>0&&(i+="..");for(var a=0;a<e.itin[r].seg.length;a++)t+="&c["+r+"].s["+a+"].os="+e.itin[r].seg[a].orig,t+="&c["+r+"].s["+a+"].ds="+e.itin[r].seg[a].dest,t+="&c["+r+"].s["+a+"].dd="+e.itin[r].seg[a].dep.year+"-"+("0"+e.itin[r].seg[a].dep.month).slice(-2)+"-"+("0"+e.itin[r].seg[a].dep.day).slice(-2),t+="&c["+r+"].s["+a+"].dt="+("0"+e.itin[r].seg[a].dep.time.replace(":","")).slice(-4),t+="&c["+r+"].s["+a+"].mc="+e.itin[r].seg[a].carrier,t+="&c["+r+"].s["+a+"].fn="+("000"+e.itin[r].seg[a].fnr).slice(-4),a>0&&(i+="."),i+=e.itin[r].seg[a].carrier}for(var r=0;r<e.farebases.length;r++)r>0&&(n+=","),n+=e.farebases[r];t+="&ref=fb="+n,1==mptUsersettings.enableInlinemode?printUrlInline(t,"KLM",""):printUrl(t,"KLM","")}function getOrbitzCabin(e){switch(e){case 2:e="B";break;case 3:e="F";break;default:e="C"}return e}function printOrbitz(e){for(var t="",n="/shop/home?type=air&source=GOOGLE_META&searchHost=ITA&ar.type=multiCity&strm=true",i=0;i<e.itin.length;i++){var r=i.toString();n+="&ar.mc.slc["+r+"].orig.key="+e.itin[i].orig,n+="&_ar.mc.slc["+r+"].originRadius=0",n+="&ar.mc.slc["+r+"].dest.key="+e.itin[i].dest,n+="&_ar.mc.slc["+r+"].destinationRadius=0";var a=e.itin[i].dep.year%100;n+="&ar.mc.slc["+r+"].date="+e.itin[i].dep.month.toString()+"/"+e.itin[i].dep.day.toString()+"/"+a.toString(),n+="&ar.mc.slc["+r+"].time=Anytime";for(var s=0;s<e.itin[i].seg.length;s++){for(var o=0;s+o<e.itin[i].seg.length-1&&!(e.itin[i].seg[s+o].fnr!=e.itin[i].seg[s+o+1].fnr||e.itin[i].seg[s+o].layoverduration>=1440);)o++;t+=e.itin[i].seg[s].carrier+e.itin[i].seg[s].fnr+e.itin[i].seg[s].orig+e.itin[i].seg[s+o].dest+(e.itin[i].seg[s].dep.month<10?"0":"")+e.itin[i].seg[s].dep.month+(e.itin[i].seg[s].dep.day<10?"0":"")+e.itin[i].seg[s].dep.day+getOrbitzCabin(e.itin[i].seg[s].cabin),t+="_",s+=o}}if(n+="&ar.mc.numAdult="+e.numPax,n+="&ar.mc.numSenior=0&ar.mc.numChild=0&ar.mc.child[0]=&ar.mc.child[1]=&ar.mc.child[2]=&ar.mc.child[3]=&ar.mc.child[4]=&ar.mc.child[5]=&ar.mc.child[6]=&ar.mc.child[7]=&search=Search Flights&ar.mc.nonStop=true&_ar.mc.nonStop=0",e.carriers.length<=3){n+="&_ar.mc.narrowSel=1&ar.mc.narrow=airlines";for(var i=0;3>i;i++)n+=i<e.carriers.length?"&ar.mc.carriers["+i+"]="+e.carriers[i]:"&ar.mc.carriers["+i+"]="}else n+="&_ar.mc.narrowSel=0&ar.mc.narrow=airlines&ar.mc.carriers[0]=&ar.mc.carriers[1]=&ar.mc.carriers[2]=";if(n+="&ar.mc.cabin=C",n+="&selectKey="+t.substring(0,t.length-1),"USD"==e.cur){var g=parseFloat(e.price)+6.99;n+="&userRate.price=USD|"+g.toString()}1==mptUsersettings.enableInlinemode?(printUrlInline("http://www.cheaptickets.com"+n,"Cheaptickets",""),printUrlInline("http://www.orbitz.com"+n,"Orbitz","")):(printUrl("http://www.cheaptickets.com"+n,"Cheaptickets",""),printUrl("http://www.orbitz.com"+n,"Orbitz",""))}function getUACabin(e){switch(e){case 2:e="Business";break;case 3:e="First";break;default:e="Coach"}return e}function printUA(e){var t='{"post": {"pax": '+e.numPax;t+=', "trips": [';for(var n=0;n<e.itin.length;n++){var i=3;t+='{"origin": "'+e.itin[n].orig+'", "dest": "'+e.itin[n].dest+'", "dep_date": "'+e.itin[n].dep.month+"/"+e.itin[n].dep.day+"/"+e.itin[n].dep.year+'", "segments": [';for(var r=0;r<e.itin[n].seg.length;r++){for(var a=0;r+a<e.itin[n].seg.length-1&&!(e.itin[n].seg[r+a].fnr!=e.itin[n].seg[r+a+1].fnr||e.itin[n].seg[r+a].layoverduration>=1440);)a++;t+='{"origin": "'+e.itin[n].seg[r].orig+'", "dep_date": "'+e.itin[n].seg[r].dep.month.toString()+"/"+e.itin[n].seg[r].dep.day.toString()+"/"+e.itin[n].seg[r].dep.year.toString()+'", "dest_date": " ", "dest": "'+e.itin[n].seg[r+a].dest+'", ',t+='"flight_num": '+e.itin[n].seg[r].fnr+', "carrier": "'+e.itin[n].seg[r].carrier+'", "fare_code": "'+e.itin[n].seg[r].farebase+'"},',e.itin[n].seg[r].cabin<i&&(i=e.itin[n].seg[r].cabin),r+=a}t=t.substring(0,t.length-1)+'],"cabin": "'+getUACabin(i)+'"},'}t="https://www.hipmunk.com/bookjs?booking_info="+encodeURIComponent(t.substring(0,t.length-1)+']}, "kind": "flight", "provider_code": "UA" }'),desc="de"==mptUsersettings.language?"Kopiere den Link bei Hipmunk":"Copy Link in Text, via Hipmunk",1==mptUsersettings.enableInlinemode?printUrlInline(t,"United",desc):printUrl(t,"United",desc)}function printAC(e){var t="http://www.aircanada.com/aco/flights.do?AH_IATA_NUMBER=0005118&AVAIL_EMMBEDDED_TRANSACTION=FlexPricerAvailabilityServlet";t+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"&country=DE&countryOfResidence=DE&language=de&LANGUAGE=DE":"&country="+mptUsersettings.acEdition.toUpperCase()+"&countryofResidence="+mptUsersettings.acEdition.toUpperCase()+"&language=en&LANGUAGE=US",t+="&CREATION_MODE=30&EMBEDDED_TRANSACTION=FareServelet&FareRequest=YES&fromThirdParty=YES&HAS_INFANT_1=False&IS_PRIMARY_TRAVELLER_1=True&SITE=SAADSAAD&thirdPartyID=0005118&TRAVELER_TYPE_1=ADT&PRICING_MODE=0",t+="&numberOfChildren=0&numberOfInfants=0&numberOfYouth=0&numberOfAdults="+e.numPax,t+="&tripType="+(e.itin.length>1?"R":"O");for(var n=0;n<e.itin.length;n++){0==n?t+="&departure1="+("0"+e.itin[n].dep.day).slice(-2)+"/"+("0"+e.itin[n].dep.month).slice(-2)+"/"+e.itin[n].dep.year+"&org1="+e.itin[n].orig+"&dest1="+e.itin[n].dest:1==n&&(t+="&departure2="+("0"+e.itin[n].dep.day).slice(-2)+"/"+("0"+e.itin[n].dep.month).slice(-2)+"/"+e.itin[n].dep.year);for(var i=0;i<e.itin[n].seg.length;i++)t+="&AIRLINE_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].carrier,t+="&B_DATE_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].dep.year+("0"+e.itin[n].seg[i].dep.month).slice(-2)+("0"+e.itin[n].seg[i].dep.day).slice(-2)+("0"+e.itin[n].seg[i].dep.time.replace(":","")).slice(-4),t+="&B_LOCATION_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].orig,t+="&E_DATE_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].arr.year+("0"+e.itin[n].seg[i].arr.month).slice(-2)+("0"+e.itin[n].seg[i].arr.day).slice(-2)+("0"+e.itin[n].seg[i].arr.time.replace(":","")).slice(-4),t+="&E_LOCATION_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].dest,t+="&FLIGHT_NUMBER_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].fnr,t+="&RBD_"+(n+1)+"_"+(i+1)+"="+e.itin[n].seg[i].bookingclass}1==mptUsersettings.enableInlinemode?printUrlInline(t,"Air Canada",""):printUrl(t,"Air Canada","")}function getUSCabin(e){switch(e){case 2:e="B";break;case 3:e="F";break;default:e="C"}return e}function printUS(e){var t="https://shopping.usairways.com/Flights/Passenger.aspx?g=goo&c=goog_US_pax";t+="&a="+e.numPax,t+="&s="+getUSCabin(e.itin[0].seg[0].cabin).toLowerCase();for(var n=0;n<e.itin.length;n++)for(var i=0;i<e.itin[n].seg.length;i++){var r=(n+1).toString()+(i+1).toString();t+="&o"+r+"="+e.itin[n].seg[i].orig+"&d"+r+"="+e.itin[n].seg[i].dest+"&f"+r+"="+e.itin[n].seg[i].fnr,t+="&t"+r+"="+e.itin[n].seg[i].dep.year+(e.itin[n].seg[i].dep.month<10?"0":"")+e.itin[n].seg[i].dep.month+(e.itin[n].seg[i].dep.day<10?"0":"")+e.itin[n].seg[i].dep.day+"0000",t+="&x"+r+"="+e.itin[n].seg[i].farebase}1==mptUsersettings.enableInlinemode?printUrlInline(t,"US Airways",""):printUrl(t,"US Airways","")}function printFarefreaks(e,t){var n=new Array,i=3,r=0,a="https://www.farefreaks.com/landing/landing.php?";a+="de"==mptSettings.itaLanguage||"de"==mptUsersettings.language?"lang=de":"lang=en",a+="&target=flightsearch&referrer=matrix";for(var s=0;s<e.itin.length;s++){1!=t&&(a+="&orig["+r+"]="+e.itin[s].orig,a+="&dest["+r+"]="+e.itin[s].dest,a+="&date["+r+"]="+e.itin[s].dep.year.toString()+"-"+e.itin[s].dep.month+"-"+e.itin[s].dep.day+"_"+e.itin[s].dep.time+":00",a+="&validtime["+r+"]=1",r++);for(var o=0;o<e.itin[s].seg.length;o++){if(1==t){for(var g=0;o+g<e.itin[s].seg.length-1&&!(e.itin[s].seg[o+g].fnr!=e.itin[s].seg[o+g+1].fnr||e.itin[s].seg[o+g].layoverduration>=1440);)g++;a+="&orig["+r+"]="+e.itin[s].seg[o].orig,a+="&dest["+r+"]="+e.itin[s].seg[o+g].dest,a+="&date["+r+"]="+e.itin[s].seg[o].dep.year.toString()+"-"+e.itin[s].seg[o].dep.month+"-"+e.itin[s].seg[o].dep.day+"_"+e.itin[s].seg[o].dep.time+":00",a+="&validtime["+r+"]=1",r++,o+=g}e.itin[s].seg[o].cabin<i&&(i=e.itin[s].seg[o].cabin),inArray(e.itin[s].seg[o].carrier,n)||n.push(e.itin[s].seg[o].carrier)}}if(a+="&adult="+e.numPax,a+="&cabin="+i,a+="&child=0&childage[]=&flexible=0",1==t)a+="&nonstop=1",desc="de"==mptUsersettings.language?"Benutze "+r+" Segment(e)":"Based on "+r+" segment(s)";else{if(1==r)return!1;a+="&nonstop=0",desc="de"==mptUsersettings.language?"Benutze "+r+" Abschnitt(e)":"Based on "+r+" segment(s)"}n.length<=3&&(a+="&carrier="+n.toString()),1==mptUsersettings.enableInlinemode&&6>=r?printUrlInline(a,"Farefreaks",desc):6>=r&&printUrl(a,"Farefreaks",desc)}function printGCM(e){for(var t="",n=0;n<e.itin.length;n++)for(var i=0;i<e.itin[n].seg.length;i++)t+=e.itin[n].seg[i].orig+"-",i+1<e.itin[n].seg.length?e.itin[n].seg[i].dest!=e.itin[n].seg[i+1].orig&&(t+=e.itin[n].seg[i].dest+";"):t+=e.itin[n].seg[i].dest+";";1==mptUsersettings.enableInlinemode?printImageInline("http://www.gcmap.com/map?MR=900&MX=182x182&PM=*&P="+t,"http://www.gcmap.com/mapui?P="+t):printUrl("http://www.gcmap.com/mapui?P="+t,"GCM","")}function getHipmunkCabin(e){switch(e){case 2:e="Business";break;case 3:e="First";break;default:e="Coach"}return e}function printHipmunk(e){for(var t="https://www.hipmunk.com/search/flights?",n=3,i=0;i<e.itin.length;i++){t+="&from"+i+"="+e.itin[i].orig;for(var r=0;r<e.itin[i].seg.length;r++){for(var a=0;r+a<e.itin[i].seg.length-1&&!(e.itin[i].seg[r+a].fnr!=e.itin[i].seg[r+a+1].fnr||e.itin[i].seg[r+a].layoverduration>=1440);)a++;t+=(r>0?"%20"+e.itin[i].seg[r].orig+"%20":"%3A%3A")+e.itin[i].seg[r].carrier+e.itin[i].seg[r].fnr,e.itin[i].seg[r].cabin<n&&(n=e.itin[i].seg[r].cabin),r+=a}t+="&date"+i+"="+e.itin[i].dep.year+"-"+(Number(e.itin[i].dep.month)<=9?"0":"")+e.itin[i].dep.month.toString()+"-"+(Number(e.itin[i].dep.day)<=9?"0":"")+e.itin[i].dep.day.toString(),t+="&to"+i+"="+e.itin[i].dest}t+="&pax="+e.numPax+"&cabin="+getHipmunkCabin(n)+"&infant_lap=0&infant_seat=0&seniors=0&children=0",1==mptUsersettings.enableInlinemode?printUrlInline(t,"Hipmunk",""):printUrl(t,"Hipmunk","")}function printPriceline(e){var t="https://www.priceline.com/airlines/landingServlet?userAction=search",n="&TripType=MD&ProductID=1";n+="&DepCity="+e.itin[0].orig,n+="&ArrCity="+e.itin[0].dest,n+="&DepartureDate="+(Number(e.itin[0].dep.month)<=9?"0":"")+e.itin[0].dep.month.toString()+"/"+(Number(e.itin[0].dep.day)<=9?"0":"")+e.itin[0].dep.day.toString()+"/"+e.itin[0].dep.year.toString();for(var i=1,r=1,a="<externalSearch>",s=0;s<e.itin.length;s++){n+="&MDCity_"+i.toString()+"="+e.itin[s].orig,n+="&DepDateMD"+i.toString()+"="+(Number(e.itin[s].dep.month)<=9?"0":"")+e.itin[s].dep.month.toString()+"/"+(Number(e.itin[s].dep.day)<=9?"0":"")+e.itin[s].dep.day.toString()+"/"+e.itin[s].dep.year.toString(),i++,n+="&MDCity_"+i.toString()+"="+e.itin[s].dest,n+="&DepDateMD"+i.toString()+"="+(Number(e.itin[s].arr.month)<=9?"0":"")+e.itin[s].arr.month.toString()+"/"+(Number(e.itin[s].arr.day)<=9?"0":"")+e.itin[s].arr.day.toString()+"/"+e.itin[s].arr.year.toString(),i++,a+="<slice>";for(var o=0;o<e.itin[s].seg.length;o++){a+="<segment>";for(var g=0;o+g<e.itin[s].seg.length-1&&!(e.itin[s].seg[o+g].fnr!=e.itin[s].seg[o+g+1].fnr||e.itin[s].seg[o+g].layoverduration>=1440);)g++;a+="<number>"+r.toString()+"</number>",a+="<departDateTime>"+(Number(e.itin[s].seg[o].dep.month)<=9?"0":"")+e.itin[s].seg[o].dep.month.toString()+"/"+(Number(e.itin[s].seg[o].dep.day)<=9?"0":"")+e.itin[s].seg[o].dep.day.toString()+"/"+e.itin[s].seg[o].dep.year.toString()+" "+e.itin[s].seg[o].dep.time+":00</departDateTime>",a+="<arrivalDateTime>"+(Number(e.itin[s].seg[o+g].arr.month)<=9?"0":"")+e.itin[s].seg[o+g].arr.month.toString()+"/"+(Number(e.itin[s].seg[o+g].arr.day)<=9?"0":"")+e.itin[s].seg[o+g].arr.day.toString()+"/"+e.itin[s].seg[o+g].arr.year.toString()+" "+e.itin[s].seg[o+g].arr.time+":00</arrivalDateTime>",a+="<origAirportCode>"+e.itin[s].seg[o].orig+"</origAirportCode>",a+="<destAirportCode>"+e.itin[s].seg[o+g].dest+"</destAirportCode>",a+="<carrierCode>"+e.itin[s].seg[o].carrier+"</carrierCode>",a+="<flightNumber>"+e.itin[s].seg[o].fnr+"</flightNumber>",a+="<equipmentCode></equipmentCode>",a+="<bookingClass>"+e.itin[s].seg[o].bookingclass+"</bookingClass>",r++,o+=g,a+="</segment>"}a+="</slice>"}a+="<numberOfTickets>"+e.numPax+"</numberOfTickets><cost><totalFare>0.00</totalFare><baseFare>0.00</baseFare><tax>0.00</tax><fee>0.00</fee></cost>",a+="</externalSearch>",n+="&NumTickets="+e.numPax+"&AirAffiliateSearch=",1==mptUsersettings.enableInlinemode?printUrlInline(t+n+encodeURIComponent(a),"Priceline",""):printUrl(t+n+encodeURIComponent(a),"Priceline","")}function printUrlInline(e,t,n,i){printItemInline('<a href="'+e+'" target="_blank">'+("de"==mptUsersettings.language?"&Ouml;ffne mit":"Open with")+" "+t+"</a>",n,i)}function printItemInline(e,t,n){div=getSidebarContainer(n),div.innerHTML=div.innerHTML+'<li class="powertoolsitem">'+e+(t?"<br/><small>("+t+")</small>":"")+"</li>"}function printImageInline(e,t,n){if(div=getSidebarContainer(n).parentNode,1==mptUsersettings.enableIMGautoload)div.innerHTML=div.innerHTML+(t?'<a href="'+t+'" target="_blank" class="powertoolsitem">':"")+'<img src="'+e+'" style="margin-top:10px;"'+(t?"":' class="powertoolsitem"')+"/>"+(t?"</a>":"");else{var i=Math.random();div.innerHTML=div.innerHTML+'<div id="'+i+'" class="powertoolsitem" style="width:184px;height:100px;background-color:white;cursor:pointer;text-align:center;margin-top:10px;padding-top:84px;"><span>Click</span></div>',document.getElementById(i).onclick=function(){var n=document.createElement("div");n.setAttribute("class","powertoolsitem"),n.innerHTML=(t?'<a href="'+t+'" target="_blank">':"")+'<img src="'+e+'" style="margin-top:10px;"'+(t?"":' class="powertoolsitem"')+"/>"+(t?"</a>":""),document.getElementById(i).parentNode.replaceChild(n,document.getElementById(i))}}}function getSidebarContainer(e){var t=!e||e>=4?document.getElementById("powertoolslinkinlinecontainer"):findtarget(classSettings.mcDiv,e);return t||createUrlContainerInline()}function createUrlContainerInline(){var e=document.createElement("div");return e.setAttribute("class",classSettings.mcDiv),e.innerHTML='<div class="'+classSettings.mcHeader+'">Powertools</div><ul id="powertoolslinkinlinecontainer" class="'+classSettings.mcLinkList+'"></ul>',findtarget(classSettings.mcDiv,1).parentNode.appendChild(e),document.getElementById("powertoolslinkinlinecontainer")}function printUrl(e,t,n){void 0==document.getElementById("powertoolslinkcontainer")&&createUrlContainer();var i=document.getElementById("powertoolslinkcontainer");i.innerHTML=i.innerHTML+'<br><br><font size=3><bold><a href="'+e+'" target=_blank>'+("de"==mptUsersettings.language?"&Ouml;ffne mit":"Open with")+" "+t+"</a></font></bold>"+(n?"<br>("+n+")":"")}function createUrlContainer(){var e=document.createElement("div");e.setAttribute("id","powertoolslinkcontainer"),e.setAttribute("style","margin-left:10px;"),findtarget(classSettings.htbContainer,1).parentNode.parentNode.parentNode.appendChild(e)}var mptUsersettings=new Object;mptUsersettings.timeformat="12h",mptUsersettings.language="en",mptUsersettings.enableInlinemode=0,mptUsersettings.enableIMGautoload=0,mptUsersettings.enableFarerules=1,mptUsersettings.enablePricebreakdown=1,mptUsersettings.acEdition="us";var acEditions=["us","ca","ar","au","ch","cl","cn","co","de","dk","es","fr","gb","hk","ie","il","it","jp","mx","nl","no","pa","pe","se"],mptSettings=new Object;mptSettings.itaLanguage="en",mptSettings.retrycount=1,mptSettings.laststatus="",mptSettings.scriptrunning=1;var classSettings=new Object;classSettings.itin="FNGTPEB-A-d",classSettings.milagecontainer="FNGTPEB-A-e",classSettings.rulescontainer="FNGTPEB-l-d",classSettings.htbContainer="FNGTPEB-F-k",classSettings.htbLeft="FNGTPEB-l-g",classSettings.htbRight="FNGTPEB-l-f",classSettings.htbGreyBorder="FNGTPEB-l-l",classSettings.mcDiv="FNGTPEB-U-e",classSettings.mcLinkList="FNGTPEB-y-c",classSettings.mcHeader="FNGTPEB-U-b",startcript();
